{"ast":null,"code":"// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.processClone = processClone;\nexports.asArray = asArray;\nexports.fourRandomChars = fourRandomChars;\nexports.uid = uid;\nexports.makeImage = makeImage;\nexports.isDataUrl = isDataUrl;\nexports.mimeType = mimeType;\nexports.dataAsUrl = dataAsUrl;\nexports.escape = escape;\nexports.delay = delay;\nexports.isSrcAsDataUrl = isSrcAsDataUrl;\nexports.canvasToBlob = canvasToBlob;\nexports.escapeXhtml = escapeXhtml;\nexports.getWidth = getWidth;\nexports.getHeight = getHeight;\nexports.resolveUrl = resolveUrl;\nexports.getAndEncode = getAndEncode;\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _console = _interopRequireDefault(require(\"global/console\"));\nvar _window = _interopRequireDefault(require(\"global/window\"));\nvar _document = _interopRequireDefault(require(\"global/document\"));\nvar _constants = require(\"@kepler.gl/constants\");\nfunction processClone(original, clone) {\n  if (!(clone instanceof _window[\"default\"].Element)) {\n    return clone;\n  }\n  function copyProperties(sourceStyle, targetStyle) {\n    var propertyKeys = asArray(sourceStyle);\n    propertyKeys.forEach(function (name) {\n      targetStyle.setProperty(name, sourceStyle.getPropertyValue(name), sourceStyle.getPropertyPriority(name));\n    });\n  }\n  function copyStyle(source, target) {\n    if (source.cssText) {\n      target.cssText = source.cssText; // add additional copy of composite styles\n\n      if (source.font) {\n        target.font = source.font;\n      }\n    } else {\n      copyProperties(source, target);\n    }\n  }\n  function cloneStyle(og, cln) {\n    var originalStyle = _window[\"default\"].getComputedStyle(og);\n    copyStyle(originalStyle, cln.style);\n  }\n  function formatPseudoElementStyle(cln, elm, stl) {\n    var formatCssText = function formatCssText(stl1) {\n      var cnt = stl1.getPropertyValue('content');\n      return \"\".concat(stl.cssText, \" content: \").concat(cnt, \";\");\n    };\n    var formatProperty = function formatProperty(name) {\n      return \"\".concat(name, \":\").concat(stl.getPropertyValue(name)).concat(stl.getPropertyPriority(name) ? ' !important' : '');\n    };\n    var formatCssProperties = function formatCssProperties(stl2) {\n      return \"\".concat(asArray(stl2).map(formatProperty).join('; '), \";\");\n    };\n    var selector = \".\".concat(cln, \":\").concat(elm);\n    var cssText = stl.cssText ? formatCssText(stl) : formatCssProperties(stl);\n    return _document[\"default\"].createTextNode(\"\".concat(selector, \"{\").concat(cssText, \"}\"));\n  }\n  function clonePseudoElement(org, cln, element) {\n    var style = _window[\"default\"].getComputedStyle(org, element);\n    var content = style.getPropertyValue('content');\n    if (content === '' || content === 'none') {\n      return;\n    }\n    var className = uid();\n    cln.className = \"\".concat(cln.className, \" \").concat(className);\n    var styleElement = _document[\"default\"].createElement('style');\n    styleElement.appendChild(formatPseudoElementStyle(className, element, style));\n    cln.appendChild(styleElement);\n  }\n  function clonePseudoElements(_ref) {\n    var _ref2 = (0, _slicedToArray2[\"default\"])(_ref, 2),\n      og = _ref2[0],\n      cln = _ref2[1];\n    [':before', ':after'].forEach(function (element) {\n      return clonePseudoElement(og, cln, element);\n    });\n  }\n  function copyUserInput(_ref3) {\n    var _ref4 = (0, _slicedToArray2[\"default\"])(_ref3, 2),\n      og = _ref4[0],\n      cln = _ref4[1];\n    if (og instanceof _window[\"default\"].HTMLTextAreaElement) cln.innerHTML = og.value;\n    if (og instanceof _window[\"default\"].HTMLInputElement) cln.setAttribute('value', og.value);\n  }\n  function fixSvg(cln) {\n    if (!(cln instanceof _window[\"default\"].SVGElement)) return;\n    cln.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    if (!(cln instanceof _window[\"default\"].SVGRectElement)) return;\n    ['width', 'height'].forEach(function (attribute) {\n      var value = cln.getAttribute(attribute);\n      if (!value) return;\n      cln.style.setProperty(attribute, value);\n    });\n  }\n  return Promise.resolve([original, clone]).then(function (_ref5) {\n    var _ref6 = (0, _slicedToArray2[\"default\"])(_ref5, 2),\n      og = _ref6[0],\n      cln = _ref6[1];\n    cloneStyle(og, cln);\n    return [og, cln];\n  }).then(function (_ref7) {\n    var _ref8 = (0, _slicedToArray2[\"default\"])(_ref7, 2),\n      og = _ref8[0],\n      cln = _ref8[1];\n    clonePseudoElements([og, cln]);\n    return [og, cln];\n  }).then(function (_ref9) {\n    var _ref10 = (0, _slicedToArray2[\"default\"])(_ref9, 2),\n      og = _ref10[0],\n      cln = _ref10[1];\n    copyUserInput([og, cln]);\n    return [og, cln];\n  }).then(function (_ref11) {\n    var _ref12 = (0, _slicedToArray2[\"default\"])(_ref11, 2),\n      og = _ref12[0],\n      cln = _ref12[1];\n    fixSvg(cln);\n    return [og, cln];\n  }).then(function (_ref13) {\n    var _ref14 = (0, _slicedToArray2[\"default\"])(_ref13, 2),\n      og = _ref14[0],\n      cln = _ref14[1];\n    return cln;\n  });\n}\n/****\n * UTILS\n ****/\n\nfunction asArray(arrayLike) {\n  var array = [];\n  var length = arrayLike.length;\n  for (var i = 0; i < length; i++) {\n    array.push(arrayLike[i]);\n  }\n  return array;\n}\nfunction fourRandomChars() {\n  /* see http://stackoverflow.com/a/6248722/2519373 */\n  return \"0000\".concat((Math.random() * Math.pow(36, 4) << 0).toString(36)).slice(-4);\n}\nfunction uid() {\n  var index = 0;\n  return \"u\".concat(fourRandomChars()).concat(index++);\n}\nfunction makeImage(uri) {\n  return new Promise(function (resolve, reject) {\n    var image = new _window[\"default\"].Image();\n    image.onload = function () {\n      resolve(image);\n    };\n    image.onerror = function (err) {\n      var message = _constants.IMAGE_EXPORT_ERRORS.dataUri;\n      _console[\"default\"].log(uri); // error is an Event Object\n      // https://www.w3schools.com/jsref/obj_event.asp\n\n      reject({\n        event: err,\n        message: message\n      });\n    };\n    image.src = uri;\n  });\n}\nfunction isDataUrl(url) {\n  return url.search(/^(data:)/) !== -1;\n}\nfunction parseExtension(url) {\n  var match = /\\.([^\\.\\/]*?)$/g.exec(url);\n  if (match) {\n    return match[1];\n  }\n  return '';\n}\nfunction mimes() {\n  /*\n   * Only WOFF and EOT mime types for fonts are 'real'\n   * see http://www.iana.org/assignments/media-types/media-types.xhtml\n   */\n  var WOFF = 'application/font-woff';\n  var JPEG = 'image/jpeg';\n  return {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml'\n  };\n}\nfunction mimeType(url) {\n  var extension = parseExtension(url).toLowerCase();\n  return mimes()[extension] || '';\n}\nfunction dataAsUrl(content, type) {\n  return \"data:\".concat(type, \";base64,\").concat(content);\n}\nfunction escape(string) {\n  return string.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n}\nfunction delay(ms) {\n  return function (arg) {\n    return new Promise(function (resolve) {\n      _window[\"default\"].setTimeout(function () {\n        resolve(arg);\n      }, ms);\n    });\n  };\n}\nfunction isSrcAsDataUrl(text) {\n  var DATA_URL_REGEX = /url\\(['\"]?(data:)([^'\"]+?)['\"]?\\)/;\n  return text.search(DATA_URL_REGEX) !== -1;\n}\nfunction cvToBlob(canvas) {\n  return new Promise(function (resolve) {\n    var binaryString = _window[\"default\"].atob(canvas.toDataURL().split(',')[1]);\n    var length = binaryString.length;\n    var binaryArray = new Uint8Array(length);\n    for (var i = 0; i < length; i++) {\n      binaryArray[i] = binaryString.charCodeAt(i);\n    }\n    resolve(new _window[\"default\"].Blob([binaryArray], {\n      type: 'image/png'\n    }));\n  });\n}\nfunction canvasToBlob(canvas) {\n  if (canvas.toBlob) return new Promise(function (resolve) {\n    canvas.toBlob(resolve);\n  });\n  return cvToBlob(canvas);\n}\nfunction escapeXhtml(string) {\n  return string.replace(/#/g, '%23').replace(/\\n/g, '%0A');\n}\nfunction getWidth(node) {\n  var leftBorder = px(node, 'border-left-width');\n  var rightBorder = px(node, 'border-right-width');\n  return node.scrollWidth + leftBorder + rightBorder;\n}\nfunction getHeight(node) {\n  var topBorder = px(node, 'border-top-width');\n  var bottomBorder = px(node, 'border-bottom-width');\n  return node.scrollHeight + topBorder + bottomBorder;\n}\nfunction px(node, styleProperty) {\n  var value = _window[\"default\"].getComputedStyle(node).getPropertyValue(styleProperty);\n  return parseFloat(value.replace('px', ''));\n}\nfunction resolveUrl(url, baseUrl) {\n  var doc = _document[\"default\"].implementation.createHTMLDocument();\n  var base = doc.createElement('base');\n  doc.head.appendChild(base);\n  var a = doc.createElement('a');\n  doc.body.appendChild(a);\n  base.href = baseUrl;\n  a.href = url;\n  return a.href;\n}\nfunction getAndEncode(url, options) {\n  var TIMEOUT = 30000;\n  if (options.cacheBust) {\n    // Cache bypass so we dont have CORS issues with cached images\n    // Source: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    url += (/\\?/.test(url) ? '&' : '?') + new Date().getTime();\n  }\n  return new Promise(function (resolve) {\n    var request = new _window[\"default\"].XMLHttpRequest();\n    request.onreadystatechange = done;\n    request.ontimeout = timeout;\n    request.responseType = 'blob';\n    request.timeout = TIMEOUT;\n    request.open('GET', url, true);\n    request.send();\n    var placeholder;\n    if (options.imagePlaceholder) {\n      var split = options.imagePlaceholder.split(/,/);\n      if (split && split[1]) {\n        placeholder = split[1];\n      }\n    }\n    function done() {\n      if (request.readyState !== 4) return;\n      if (request.status !== 200) {\n        if (placeholder) {\n          resolve(placeholder);\n        } else {\n          fail(\"cannot fetch resource: \".concat(url, \", status: \").concat(request.status));\n        }\n        return;\n      }\n      var encoder = new _window[\"default\"].FileReader();\n      encoder.onloadend = function () {\n        var content = encoder.result.split(/,/)[1];\n        resolve(content);\n      };\n      encoder.readAsDataURL(request.response);\n    }\n    function timeout() {\n      if (placeholder) {\n        resolve(placeholder);\n      } else {\n        fail(\"timeout of \".concat(TIMEOUT, \"ms occurred while fetching resource: \").concat(url));\n      }\n    }\n    function fail(message) {\n      _console[\"default\"].error(message);\n      resolve('');\n    }\n  });\n}","map":{"version":3,"names":["exports","processClone","fourRandomChars","makeImage","mimeType","escape","delay","isSrcAsDataUrl","canvasToBlob","escapeXhtml","getWidth","getHeight","resolveUrl","getAndEncode","_slicedToArray2","_interopRequireDefault","require","_console","_window","_document","_constants","original","clone","Element","propertyKeys","asArray","sourceStyle","forEach","name","targetStyle","setProperty","getPropertyValue","getPropertyPriority","source","cssText","target","font","copyProperties","originalStyle","getComputedStyle","og","formatCssText","stl1","cnt","concat","stl","stl2","map","formatProperty","join","formatCssProperties","createTextNode","selector","style","org","element","cln","className","appendChild","styleElement","_ref2","_ref","clonePseudoElement","_ref4","_ref3","HTMLInputElement","setAttribute","value","SVGElement","SVGRectElement","attribute","getAttribute","_ref6","_ref5","then","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","array","length","arrayLike","push","i","Math","random","pow","toString","slice","index","Promise","resolve","reject","image","Image","message","IMAGE_EXPORT_ERRORS","dataUri","event","err","url","search","match","exec","WOFF","JPEG","woff","woff2","ttf","eot","png","jpg","jpeg","gif","tiff","svg","extension","parseExtension","toLowerCase","mimes","type","content","string","replace","arg","setTimeout","ms","DATA_URL_REGEX","text","binaryString","atob","canvas","toDataURL","split","binaryArray","Uint8Array","charCodeAt","toBlob","cvToBlob","leftBorder","px","node","rightBorder","scrollWidth","topBorder","bottomBorder","scrollHeight","styleProperty","doc","implementation","createHTMLDocument","head","base","a","createElement","body","href","baseUrl","TIMEOUT","test","Date","getTime","request","XMLHttpRequest","onreadystatechange","done","ontimeout","timeout","responseType","open","send","placeholder","options","imagePlaceholder","readyState","fail","status","encoder","result","error"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@kepler.gl/utils/src/dom-utils.ts"],"sourcesContent":["// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport Console from 'global/console';\nimport window from 'global/window';\nimport document from 'global/document';\nimport {IMAGE_EXPORT_ERRORS} from '@kepler.gl/constants';\n\nexport function processClone(original, clone) {\n  if (!(clone instanceof window.Element)) {\n    return clone;\n  }\n\n  function copyProperties(sourceStyle, targetStyle) {\n    const propertyKeys = asArray(sourceStyle);\n    propertyKeys.forEach(name => {\n      targetStyle.setProperty(\n        name,\n        sourceStyle.getPropertyValue(name),\n        sourceStyle.getPropertyPriority(name)\n      );\n    });\n  }\n\n  function copyStyle(source, target) {\n    if (source.cssText) {\n      target.cssText = source.cssText;\n      // add additional copy of composite styles\n      if (source.font) {\n        target.font = source.font;\n      }\n    } else {\n      copyProperties(source, target);\n    }\n  }\n\n  function cloneStyle(og, cln) {\n    const originalStyle = window.getComputedStyle(og);\n    copyStyle(originalStyle, cln.style);\n  }\n\n  function formatPseudoElementStyle(cln, elm, stl) {\n    const formatCssText = stl1 => {\n      const cnt = stl1.getPropertyValue('content');\n      return `${stl.cssText} content: ${cnt};`;\n    };\n\n    const formatProperty = name => {\n      return `${name}:${stl.getPropertyValue(name)}${\n        stl.getPropertyPriority(name) ? ' !important' : ''\n      }`;\n    };\n\n    const formatCssProperties = stl2 => {\n      return `${asArray(stl2)\n        .map(formatProperty)\n        .join('; ')};`;\n    };\n\n    const selector = `.${cln}:${elm}`;\n    const cssText = stl.cssText ? formatCssText(stl) : formatCssProperties(stl);\n\n    return document.createTextNode(`${selector}{${cssText}}`);\n  }\n\n  function clonePseudoElement(org, cln, element) {\n    const style = window.getComputedStyle(org, element);\n    const content = style.getPropertyValue('content');\n\n    if (content === '' || content === 'none') {\n      return;\n    }\n\n    const className = uid();\n    cln.className = `${cln.className} ${className}`;\n    const styleElement = document.createElement('style');\n    styleElement.appendChild(formatPseudoElementStyle(className, element, style));\n    cln.appendChild(styleElement);\n  }\n\n  function clonePseudoElements([og, cln]) {\n    [':before', ':after'].forEach(element => clonePseudoElement(og, cln, element));\n  }\n\n  function copyUserInput([og, cln]) {\n    if (og instanceof window.HTMLTextAreaElement) cln.innerHTML = og.value;\n    if (og instanceof window.HTMLInputElement) cln.setAttribute('value', og.value);\n  }\n\n  function fixSvg(cln) {\n    if (!(cln instanceof window.SVGElement)) return;\n    cln.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\n    if (!(cln instanceof window.SVGRectElement)) return;\n    ['width', 'height'].forEach(attribute => {\n      const value = cln.getAttribute(attribute);\n      if (!value) return;\n\n      cln.style.setProperty(attribute, value);\n    });\n  }\n\n  return Promise.resolve([original, clone])\n    .then(([og, cln]) => {\n      cloneStyle(og, cln);\n      return [og, cln];\n    })\n    .then(([og, cln]) => {\n      clonePseudoElements([og, cln]);\n      return [og, cln];\n    })\n    .then(([og, cln]) => {\n      copyUserInput([og, cln]);\n      return [og, cln];\n    })\n    .then(([og, cln]) => {\n      fixSvg(cln);\n      return [og, cln];\n    })\n    .then(([og, cln]) => cln);\n}\n\n/****\n * UTILS\n ****/\nexport function asArray(arrayLike) {\n  const array: any[] = [];\n  const length = arrayLike.length;\n  for (let i = 0; i < length; i++) array.push(arrayLike[i]);\n  return array;\n}\n\nexport function fourRandomChars() {\n  /* see http://stackoverflow.com/a/6248722/2519373 */\n  return `0000${((Math.random() * Math.pow(36, 4)) << 0).toString(36)}`.slice(-4);\n}\n\nexport function uid() {\n  let index = 0;\n\n  return `u${fourRandomChars()}${index++}`;\n}\n\nexport function makeImage(uri) {\n  return new Promise((resolve, reject) => {\n    const image = new window.Image();\n    image.onload = () => {\n      resolve(image);\n    };\n    image.onerror = err => {\n      const message = IMAGE_EXPORT_ERRORS.dataUri;\n      Console.log(uri);\n      // error is an Event Object\n      // https://www.w3schools.com/jsref/obj_event.asp\n      reject({event: err, message});\n    };\n    image.src = uri;\n  });\n}\n\nexport function isDataUrl(url) {\n  return url.search(/^(data:)/) !== -1;\n}\n\nfunction parseExtension(url) {\n  const match = /\\.([^\\.\\/]*?)$/g.exec(url);\n  if (match) {\n    return match[1];\n  }\n  return '';\n}\n\nfunction mimes() {\n  /*\n   * Only WOFF and EOT mime types for fonts are 'real'\n   * see http://www.iana.org/assignments/media-types/media-types.xhtml\n   */\n  const WOFF = 'application/font-woff';\n  const JPEG = 'image/jpeg';\n\n  return {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml'\n  };\n}\n\nexport function mimeType(url) {\n  const extension = parseExtension(url).toLowerCase();\n  return mimes()[extension] || '';\n}\n\nexport function dataAsUrl(content, type) {\n  return `data:${type};base64,${content}`;\n}\n\nexport function escape(string) {\n  return string.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n}\n\nexport function delay(ms) {\n  return arg => {\n    return new Promise(resolve => {\n      window.setTimeout(() => {\n        resolve(arg);\n      }, ms);\n    });\n  };\n}\n\nexport function isSrcAsDataUrl(text) {\n  const DATA_URL_REGEX = /url\\(['\"]?(data:)([^'\"]+?)['\"]?\\)/;\n\n  return text.search(DATA_URL_REGEX) !== -1;\n}\n\nfunction cvToBlob(canvas) {\n  return new Promise(resolve => {\n    const binaryString = window.atob(canvas.toDataURL().split(',')[1]);\n    const length = binaryString.length;\n    const binaryArray = new Uint8Array(length);\n\n    for (let i = 0; i < length; i++) binaryArray[i] = binaryString.charCodeAt(i);\n\n    resolve(new window.Blob([binaryArray], {type: 'image/png'}));\n  });\n}\n\nexport function canvasToBlob(canvas) {\n  if (canvas.toBlob)\n    return new Promise(resolve => {\n      canvas.toBlob(resolve);\n    });\n\n  return cvToBlob(canvas);\n}\n\nexport function escapeXhtml(string) {\n  return string.replace(/#/g, '%23').replace(/\\n/g, '%0A');\n}\n\nexport function getWidth(node) {\n  const leftBorder = px(node, 'border-left-width');\n  const rightBorder = px(node, 'border-right-width');\n  return node.scrollWidth + leftBorder + rightBorder;\n}\n\nexport function getHeight(node) {\n  const topBorder = px(node, 'border-top-width');\n  const bottomBorder = px(node, 'border-bottom-width');\n  return node.scrollHeight + topBorder + bottomBorder;\n}\n\nfunction px(node, styleProperty) {\n  const value = window.getComputedStyle(node).getPropertyValue(styleProperty);\n  return parseFloat(value.replace('px', ''));\n}\n\nexport function resolveUrl(url, baseUrl) {\n  const doc = document.implementation.createHTMLDocument();\n  const base = doc.createElement('base');\n  doc.head.appendChild(base);\n  const a = doc.createElement('a');\n  doc.body.appendChild(a);\n  base.href = baseUrl;\n  a.href = url;\n  return a.href;\n}\n\nexport function getAndEncode(url, options) {\n  const TIMEOUT = 30000;\n  if (options.cacheBust) {\n    // Cache bypass so we dont have CORS issues with cached images\n    // Source: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    url += (/\\?/.test(url) ? '&' : '?') + new Date().getTime();\n  }\n\n  return new Promise(resolve => {\n    const request = new window.XMLHttpRequest();\n\n    request.onreadystatechange = done;\n    request.ontimeout = timeout;\n    request.responseType = 'blob';\n    request.timeout = TIMEOUT;\n    request.open('GET', url, true);\n    request.send();\n\n    let placeholder;\n    if (options.imagePlaceholder) {\n      const split = options.imagePlaceholder.split(/,/);\n      if (split && split[1]) {\n        placeholder = split[1];\n      }\n    }\n\n    function done() {\n      if (request.readyState !== 4) return;\n\n      if (request.status !== 200) {\n        if (placeholder) {\n          resolve(placeholder);\n        } else {\n          fail(`cannot fetch resource: ${url}, status: ${request.status}`);\n        }\n\n        return;\n      }\n\n      const encoder = new window.FileReader();\n      encoder.onloadend = () => {\n        const content = encoder.result.split(/,/)[1];\n        resolve(content);\n      };\n      encoder.readAsDataURL(request.response);\n    }\n\n    function timeout() {\n      if (placeholder) {\n        resolve(placeholder);\n      } else {\n        fail(`timeout of ${TIMEOUT}ms occurred while fetching resource: ${url}`);\n      }\n    }\n\n    function fail(message) {\n      Console.error(message);\n      resolve('');\n    }\n  });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}