{"ast":null,"code":"import _classCallCheck from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { convertToArrayRow, convertToObjectRow } from '../utils/row-utils';\nvar DEFAULT_ROW_COUNT = 100;\nvar RowTableBatchAggregator = /*#__PURE__*/function () {\n  function RowTableBatchAggregator(schema, options) {\n    _classCallCheck(this, RowTableBatchAggregator);\n    _defineProperty(this, \"schema\", void 0);\n    _defineProperty(this, \"options\", void 0);\n    _defineProperty(this, \"length\", 0);\n    _defineProperty(this, \"objectRows\", null);\n    _defineProperty(this, \"arrayRows\", null);\n    _defineProperty(this, \"cursor\", 0);\n    _defineProperty(this, \"_headers\", []);\n    this.options = options;\n    this.schema = schema;\n    if (!Array.isArray(schema)) {\n      this._headers = [];\n      for (var key in schema) {\n        this._headers[schema[key].index] = schema[key].name;\n      }\n    }\n  }\n  _createClass(RowTableBatchAggregator, [{\n    key: \"rowCount\",\n    value: function rowCount() {\n      return this.length;\n    }\n  }, {\n    key: \"addArrayRow\",\n    value: function addArrayRow(row, cursor) {\n      if (Number.isFinite(cursor)) {\n        this.cursor = cursor;\n      }\n      switch (this.options.shape) {\n        case 'object-row-table':\n          var rowObject = convertToObjectRow(row, this._headers);\n          this.addObjectRow(rowObject, cursor);\n          break;\n        case 'array-row-table':\n          this.arrayRows = this.arrayRows || new Array(DEFAULT_ROW_COUNT);\n          this.arrayRows[this.length] = row;\n          this.length++;\n          break;\n      }\n    }\n  }, {\n    key: \"addObjectRow\",\n    value: function addObjectRow(row, cursor) {\n      if (Number.isFinite(cursor)) {\n        this.cursor = cursor;\n      }\n      switch (this.options.shape) {\n        case 'array-row-table':\n          var rowArray = convertToArrayRow(row, this._headers);\n          this.addArrayRow(rowArray, cursor);\n          break;\n        case 'object-row-table':\n          this.objectRows = this.objectRows || new Array(DEFAULT_ROW_COUNT);\n          this.objectRows[this.length] = row;\n          this.length++;\n          break;\n      }\n    }\n  }, {\n    key: \"getBatch\",\n    value: function getBatch() {\n      var rows = this.arrayRows || this.objectRows;\n      if (!rows) {\n        return null;\n      }\n      rows = rows.slice(0, this.length);\n      this.arrayRows = null;\n      this.objectRows = null;\n      return {\n        shape: this.options.shape,\n        batchType: 'data',\n        data: rows,\n        length: this.length,\n        schema: this.schema,\n        cursor: this.cursor\n      };\n    }\n  }]);\n  return RowTableBatchAggregator;\n}();\nexport { RowTableBatchAggregator as default };","map":{"version":3,"names":["convertToArrayRow","convertToObjectRow","DEFAULT_ROW_COUNT","RowTableBatchAggregator","schema","options","_classCallCheck","_defineProperty","Array","isArray","_headers","key","index","name","_createClass","value","rowCount","length","addArrayRow","row","cursor","Number","isFinite","shape","rowObject","addObjectRow","arrayRows","rowArray","objectRows","getBatch","rows","slice","batchType","data","default"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@loaders.gl/schema/src/lib/batches/row-table-batch-aggregator.ts"],"sourcesContent":["import type {Schema} from '../schema/schema';\nimport type {TableBatch} from '../../category/table/table-types';\n// import type {ArrayRowTableBatch, ObjectRowTableBatch} from '../../category/table';\nimport {convertToArrayRow, convertToObjectRow} from '../utils/row-utils';\nimport {TableBatchAggregator, TableBatchOptions} from './table-batch-aggregator';\n\nconst DEFAULT_ROW_COUNT = 100;\n\nexport default class RowTableBatchAggregator implements TableBatchAggregator {\n  schema: Schema;\n  options: TableBatchOptions;\n\n  length: number = 0;\n  objectRows: {[columnName: string]: any} | null = null;\n  arrayRows: any[] | null = null;\n  cursor: number = 0;\n  private _headers: string[] = [];\n\n  constructor(schema: Schema, options: TableBatchOptions) {\n    this.options = options;\n    this.schema = schema;\n\n    // schema is an array if there're no headers\n    // object if there are headers\n    if (!Array.isArray(schema)) {\n      this._headers = [];\n      for (const key in schema) {\n        this._headers[schema[key].index] = schema[key].name;\n      }\n    }\n  }\n\n  rowCount(): number {\n    return this.length;\n  }\n\n  addArrayRow(row: any[], cursor?: number): void {\n    if (Number.isFinite(cursor)) {\n      this.cursor = cursor as number;\n    }\n\n    // eslint-disable-next-line default-case\n    switch (this.options.shape) {\n      case 'object-row-table':\n        const rowObject = convertToObjectRow(row, this._headers);\n        this.addObjectRow(rowObject, cursor);\n        break;\n      case 'array-row-table':\n        this.arrayRows = this.arrayRows || new Array(DEFAULT_ROW_COUNT);\n        this.arrayRows[this.length] = row;\n        this.length++;\n        break;\n    }\n  }\n\n  addObjectRow(row: {[columnName: string]: any}, cursor?: number): void {\n    if (Number.isFinite(cursor)) {\n      this.cursor = cursor as number;\n    }\n\n    // eslint-disable-next-line default-case\n    switch (this.options.shape) {\n      case 'array-row-table':\n        const rowArray = convertToArrayRow(row, this._headers);\n        this.addArrayRow(rowArray, cursor);\n        break;\n      case 'object-row-table':\n        this.objectRows = this.objectRows || new Array(DEFAULT_ROW_COUNT);\n        this.objectRows[this.length] = row;\n        this.length++;\n        break;\n    }\n  }\n\n  getBatch(): TableBatch | null {\n    let rows = this.arrayRows || this.objectRows;\n    if (!rows) {\n      return null;\n    }\n\n    rows = rows.slice(0, this.length);\n    this.arrayRows = null;\n    this.objectRows = null;\n\n    return {\n      shape: this.options.shape,\n      batchType: 'data',\n      data: rows,\n      length: this.length,\n      schema: this.schema,\n      cursor: this.cursor\n    };\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}