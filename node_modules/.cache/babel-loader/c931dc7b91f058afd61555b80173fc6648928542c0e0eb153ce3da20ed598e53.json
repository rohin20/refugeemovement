{"ast":null,"code":"// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _reactMapGl = _interopRequireDefault(require(\"react-map-gl\"));\nvar _styledComponents2 = require(\"../common/styled-components\");\nvar _styles = require(\"@kepler.gl/styles\");\nvar _utils = require(\"@kepler.gl/utils\");\nvar _reactIntl = require(\"react-intl\");\nvar _localization = require(\"@kepler.gl/localization\");\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5;\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2[\"default\"])(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return (0, _possibleConstructorReturn2[\"default\"])(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nvar MapH = 190;\nvar MapW = 264;\nvar ErrorMsg = {\n  styleError: 'Failed to load map style, make sure it is published. For private style, paste in your access token.'\n};\nvar PreviewMap = _styledComponents[\"default\"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  align-items: center;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  margin-left: 116px;\\n  flex-shrink: 0;\\n\\n  .preview-title {\\n    font-weight: 500;\\n    font-size: 10px;\\n    padding: 8px 0px;\\n  }\\n\\n  .preview-title.error {\\n    color: \", \";\\n  }\\n\\n  \", \";\\n\\n  \", \";\\n\"])), function (props) {\n  return props.theme.errorColor;\n}, _styles.media.portable(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n    margin-left: 32px;\\n  \"]))), _styles.media.palm(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n    margin-left: unset;\\n    .preview-title {\\n      margin-top: 0px;\\n    }\\n  \"]))));\nvar StyledPreviewImage = _styledComponents[\"default\"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  background: \", \";\\n  border-radius: 4px;\\n  box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.18);\\n  width: \", \"px;\\n  height: \", \"px;\\n  position: relative;\\n\\n  .preview-image-placeholder {\\n    position: absolute;\\n    top: 0;\\n    left: 0;\\n  }\\n\\n  .preview-image-spinner {\\n    position: absolute;\\n    left: calc(50% - 25px);\\n    top: calc(50% - 25px);\\n  }\\n\"])), function (props) {\n  return props.theme.modalImagePlaceHolder;\n}, MapW, MapH);\nvar InlineLink = _styledComponents[\"default\"].a(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  font-weight: 500;\\n\\n  :hover {\\n    cursor: pointer;\\n  }\\n\"])));\nfunction AddMapStyleModalFactory() {\n  var AddMapStyleModal = /*#__PURE__*/function (_Component) {\n    (0, _inherits2[\"default\"])(AddMapStyleModal, _Component);\n    var _super = _createSuper(AddMapStyleModal);\n    function AddMapStyleModal() {\n      var _this;\n      (0, _classCallCheck2[\"default\"])(this, AddMapStyleModal);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _super.call.apply(_super, [this].concat(args));\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"state\", {\n        reRenderKey: 0,\n        previousToken: null\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"mapRef\", void 0);\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_map\", void 0);\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"loadMapStyleJson\", function (style) {\n        _this.props.loadCustomMapStyle({\n          style: style,\n          error: false\n        });\n      });\n      (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"loadMapStyleError\", function () {\n        _this.props.loadCustomMapStyle({\n          error: true\n        });\n      });\n      return _this;\n    }\n    (0, _createClass2[\"default\"])(AddMapStyleModal, [{\n      key: \"componentDidUpdate\",\n      value: function componentDidUpdate() {\n        var _this2 = this;\n        var map = this.mapRef && this.mapRef.getMap();\n        if (map && this._map !== map) {\n          this._map = map;\n          map.on('style.load', function () {\n            var style = map.getStyle();\n            _this2.loadMapStyleJson(style);\n          });\n          map.on('error', function () {\n            _this2.loadMapStyleError();\n          });\n        }\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _this3 = this;\n        var _this$props = this.props,\n          inputStyle = _this$props.inputStyle,\n          mapState = _this$props.mapState,\n          mapboxApiUrl = _this$props.mapboxApiUrl,\n          intl = _this$props.intl;\n        var mapboxApiAccessToken = inputStyle.accessToken || this.props.mapboxApiAccessToken;\n        var mapProps = _objectSpread(_objectSpread({}, mapState), {}, {\n          mapboxApiUrl: mapboxApiUrl,\n          mapboxApiAccessToken: mapboxApiAccessToken,\n          preserveDrawingBuffer: true,\n          transformRequest: _utils.transformRequest\n        });\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"add-map-style-modal\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledModalContent, null, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledModalVerticalPanel, null, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledModalSection, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-title\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_localization.FormattedMessage, {\n          id: 'modal.addStyle.pasteTitle'\n        })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-subtitle\"\n        }, intl.formatMessage({\n          id: 'modal.addStyle.pasteSubtitle0'\n        }), /*#__PURE__*/_react[\"default\"].createElement(InlineLink, {\n          target: \"_blank\",\n          href: \"https://www.mapbox.com/help/studio-manual-publish/#style-url\"\n        }, ' ', intl.formatMessage({\n          id: 'modal.addStyle.pasteSubtitle2'\n        })), ' ', intl.formatMessage({\n          id: 'modal.addStyle.pasteSubtitle3'\n        }), /*#__PURE__*/_react[\"default\"].createElement(InlineLink, {\n          target: \"_blank\",\n          href: \"https://docs.mapbox.com/mapbox-gl-js/style-spec\"\n        }, ' ', intl.formatMessage({\n          id: 'modal.addStyle.pasteSubtitle4'\n        }))), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.InputLight, {\n          type: \"text\",\n          value: inputStyle.url || '',\n          onChange: function onChange(_ref) {\n            var value = _ref.target.value;\n            return _this3.props.inputMapStyle({\n              url: value\n            });\n          },\n          placeholder: \"e.g. mapbox://styles/username/style, http://my.stles.com/xxx/style.json \"\n        })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledModalSection, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-title\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_localization.FormattedMessage, {\n          id: 'modal.addStyle.publishTitle'\n        })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-subtitle\"\n        }, intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle1'\n        }), /*#__PURE__*/_react[\"default\"].createElement(InlineLink, {\n          target: \"_blank\",\n          href: \"https://www.mapbox.com/studio/styles/\"\n        }, ' ', \"mapbox\"), ' ', intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle2'\n        }), /*#__PURE__*/_react[\"default\"].createElement(InlineLink, {\n          target: \"_blank\",\n          href: \"https://www.mapbox.com/help/studio-manual-publish/\"\n        }, ' ', intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle3'\n        })), ' ', intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle4'\n        })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-subtitle\"\n        }, intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle5'\n        }), /*#__PURE__*/_react[\"default\"].createElement(InlineLink, {\n          target: \"_blank\",\n          href: \"https://www.mapbox.com/help/how-access-tokens-work/\"\n        }, ' ', intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle6'\n        })), ' ', intl.formatMessage({\n          id: 'modal.addStyle.publishSubtitle7'\n        })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.InputLight, {\n          type: \"text\",\n          value: inputStyle.accessToken || '',\n          onChange: function onChange(_ref2) {\n            var value = _ref2.target.value;\n            return _this3.props.inputMapStyle({\n              accessToken: value\n            });\n          },\n          placeholder: intl.formatMessage({\n            id: 'modal.addStyle.exampleToken'\n          })\n        })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledModalSection, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"modal-section-title\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_localization.FormattedMessage, {\n          id: 'modal.addStyle.namingTitle'\n        })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.InputLight, {\n          type: \"text\",\n          value: inputStyle.label || '',\n          onChange: function onChange(_ref3) {\n            var value = _ref3.target.value;\n            return _this3.props.inputMapStyle({\n              label: value\n            });\n          }\n        }))), /*#__PURE__*/_react[\"default\"].createElement(PreviewMap, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: (0, _classnames[\"default\"])('preview-title', {\n            error: inputStyle.error\n          })\n        }, inputStyle.error ? ErrorMsg.styleError : inputStyle.style && inputStyle.style.name || ''), /*#__PURE__*/_react[\"default\"].createElement(StyledPreviewImage, {\n          className: \"preview-image\"\n        }, !inputStyle.isValid ? /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: \"preview-image-spinner\"\n        }) : /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.StyledMapContainer, null, /*#__PURE__*/_react[\"default\"].createElement(_reactMapGl[\"default\"], (0, _extends2[\"default\"])({}, mapProps, {\n          ref: function ref(el) {\n            _this3.mapRef = el;\n          },\n          key: this.state.reRenderKey,\n          width: MapW,\n          height: MapH,\n          mapStyle: inputStyle.url === null ? undefined : inputStyle.url\n        })))))));\n      }\n    }], [{\n      key: \"getDerivedStateFromProps\",\n      value: function getDerivedStateFromProps(props, state) {\n        if (props.inputStyle && props.inputStyle.accessToken && props.inputStyle.accessToken !== state.previousToken) {\n          // toke has changed\n          // ReactMapGl doesn't re-create map when token has changed\n          // here we force the map to update\n          return {\n            reRenderKey: state.reRenderKey + 1,\n            previousToken: props.inputStyle.accessToken\n          };\n        }\n        return null;\n      }\n    }]);\n    return AddMapStyleModal;\n  }(_react.Component);\n  return (0, _reactIntl.injectIntl)((0, _reactLifecyclesCompat.polyfill)(AddMapStyleModal));\n}\nvar _default = AddMapStyleModalFactory;\nexports[\"default\"] = _default;","map":{"version":3,"names":["exports","_extends2","_interopRequireDefault","require","_classCallCheck2","_createClass2","_assertThisInitialized2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_defineProperty2","_taggedTemplateLiteral2","_styledComponents2","_styles","_utils","_reactIntl","_localization","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","ownKeys","MapH","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","ErrorMsg","styleError","props","theme","errorColor","media","portable","palm","modalImagePlaceHolder","MapW","InlineLink","_styledComponents","a","AddMapStyleModalFactory","AddMapStyleModal","_Component","_super","_this","_len","args","Array","_key","reRenderKey","previousToken","loadCustomMapStyle","style","error","value","componentDidUpdate","map","mapRef","getMap","_map","on","_this2","loadMapStyleJson","loadMapStyleError","render","_this3","_this$props","inputStyle","mapState","mapboxApiUrl","intl","mapboxApiAccessToken","accessToken","mapProps","preserveDrawingBuffer","transformRequest","_react","createElement","className","StyledModalContent","StyledModalVerticalPanel","StyledModalSection","FormattedMessage","id","formatMessage","href","InputLight","type","url","onChange","_ref","inputMapStyle","placeholder","_ref2","label","_ref3","PreviewMap","_classnames","name","StyledPreviewImage","isValid","StyledMapContainer","_reactMapGl","ref","el","state","width","height","mapStyle","undefined","getDerivedStateFromProps"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@kepler.gl/components/src/modals/add-map-style-modal.tsx"],"sourcesContent":["// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {Component} from 'react';\nimport {polyfill} from 'react-lifecycles-compat';\nimport classnames from 'classnames';\nimport styled from 'styled-components';\nimport MapboxGLMap, {MapRef} from 'react-map-gl';\nimport {\n  StyledModalContent,\n  InputLight,\n  StyledMapContainer,\n  StyledModalVerticalPanel,\n  StyledModalSection\n} from '../common/styled-components';\nimport {media} from '@kepler.gl/styles';\n\n// Utils\nimport {transformRequest} from '@kepler.gl/utils';\nimport {injectIntl, IntlShape} from 'react-intl';\nimport {FormattedMessage} from '@kepler.gl/localization';\nimport mapboxgl from 'mapbox-gl';\nimport {InputStyle, MapState} from '@kepler.gl/types';\n\nconst MapH = 190;\nconst MapW = 264;\nconst ErrorMsg = {\n  styleError:\n    'Failed to load map style, make sure it is published. For private style, paste in your access token.'\n};\n\nconst PreviewMap = styled.div`\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  margin-left: 116px;\n  flex-shrink: 0;\n\n  .preview-title {\n    font-weight: 500;\n    font-size: 10px;\n    padding: 8px 0px;\n  }\n\n  .preview-title.error {\n    color: ${props => props.theme.errorColor};\n  }\n\n  ${media.portable`\n    margin-left: 32px;\n  `};\n\n  ${media.palm`\n    margin-left: unset;\n    .preview-title {\n      margin-top: 0px;\n    }\n  `};\n`;\n\nconst StyledPreviewImage = styled.div`\n  background: ${props => props.theme.modalImagePlaceHolder};\n  border-radius: 4px;\n  box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.18);\n  width: ${MapW}px;\n  height: ${MapH}px;\n  position: relative;\n\n  .preview-image-placeholder {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n\n  .preview-image-spinner {\n    position: absolute;\n    left: calc(50% - 25px);\n    top: calc(50% - 25px);\n  }\n`;\n\nconst InlineLink = styled.a`\n  font-weight: 500;\n\n  :hover {\n    cursor: pointer;\n  }\n`;\n\ninterface AddMapStyleModalProps {\n  inputMapStyle: Function;\n  inputStyle: InputStyle;\n  loadCustomMapStyle: Function;\n  mapboxApiAccessToken: string;\n  mapboxApiUrl?: string;\n  mapState: MapState;\n  intl: IntlShape;\n}\n\nfunction AddMapStyleModalFactory() {\n  class AddMapStyleModal extends Component<AddMapStyleModalProps> {\n    state = {\n      reRenderKey: 0,\n      previousToken: null\n    };\n\n    static getDerivedStateFromProps(props, state) {\n      if (\n        props.inputStyle &&\n        props.inputStyle.accessToken &&\n        props.inputStyle.accessToken !== state.previousToken\n      ) {\n        // toke has changed\n        // ReactMapGl doesn't re-create map when token has changed\n        // here we force the map to update\n\n        return {\n          reRenderKey: state.reRenderKey + 1,\n          previousToken: props.inputStyle.accessToken\n        };\n      }\n\n      return null;\n    }\n\n    mapRef: MapRef | null | undefined;\n    _map: mapboxgl.Map | undefined;\n\n    componentDidUpdate() {\n      const map = this.mapRef && this.mapRef.getMap();\n      if (map && this._map !== map) {\n        this._map = map;\n\n        map.on('style.load', () => {\n          const style = map.getStyle();\n          this.loadMapStyleJson(style);\n        });\n\n        map.on('error', () => {\n          this.loadMapStyleError();\n        });\n      }\n    }\n\n    loadMapStyleJson = style => {\n      this.props.loadCustomMapStyle({style, error: false});\n    };\n\n    loadMapStyleError = () => {\n      this.props.loadCustomMapStyle({error: true});\n    };\n\n    render() {\n      const {inputStyle, mapState, mapboxApiUrl, intl} = this.props;\n\n      const mapboxApiAccessToken = inputStyle.accessToken || this.props.mapboxApiAccessToken;\n      const mapProps = {\n        ...mapState,\n        mapboxApiUrl,\n        mapboxApiAccessToken,\n        preserveDrawingBuffer: true,\n        transformRequest\n      };\n\n      return (\n        <div className=\"add-map-style-modal\">\n          <StyledModalContent>\n            <StyledModalVerticalPanel>\n              <StyledModalSection>\n                <div className=\"modal-section-title\">\n                  <FormattedMessage id={'modal.addStyle.pasteTitle'} />\n                </div>\n                <div className=\"modal-section-subtitle\">\n                  {intl.formatMessage({id: 'modal.addStyle.pasteSubtitle0'})}\n                  <InlineLink\n                    target=\"_blank\"\n                    href=\"https://www.mapbox.com/help/studio-manual-publish/#style-url\"\n                  >\n                    {' '}\n                    {intl.formatMessage({id: 'modal.addStyle.pasteSubtitle2'})}\n                  </InlineLink>{' '}\n                  {intl.formatMessage({id: 'modal.addStyle.pasteSubtitle3'})}\n                  <InlineLink\n                    target=\"_blank\"\n                    href=\"https://docs.mapbox.com/mapbox-gl-js/style-spec\"\n                  >\n                    {' '}\n                    {intl.formatMessage({id: 'modal.addStyle.pasteSubtitle4'})}\n                  </InlineLink>\n                </div>\n                <InputLight\n                  type=\"text\"\n                  value={inputStyle.url || ''}\n                  onChange={({target: {value}}) => this.props.inputMapStyle({url: value})}\n                  placeholder=\"e.g. mapbox://styles/username/style, http://my.stles.com/xxx/style.json \"\n                />\n              </StyledModalSection>\n\n              <StyledModalSection>\n                <div className=\"modal-section-title\">\n                  <FormattedMessage id={'modal.addStyle.publishTitle'} />\n                </div>\n                <div className=\"modal-section-subtitle\">\n                  {intl.formatMessage({id: 'modal.addStyle.publishSubtitle1'})}\n                  <InlineLink target=\"_blank\" href=\"https://www.mapbox.com/studio/styles/\">\n                    {' '}\n                    mapbox\n                  </InlineLink>{' '}\n                  {intl.formatMessage({id: 'modal.addStyle.publishSubtitle2'})}\n                  <InlineLink\n                    target=\"_blank\"\n                    href=\"https://www.mapbox.com/help/studio-manual-publish/\"\n                  >\n                    {' '}\n                    {intl.formatMessage({id: 'modal.addStyle.publishSubtitle3'})}\n                  </InlineLink>{' '}\n                  {intl.formatMessage({id: 'modal.addStyle.publishSubtitle4'})}\n                </div>\n\n                <div className=\"modal-section-subtitle\">\n                  {intl.formatMessage({id: 'modal.addStyle.publishSubtitle5'})}\n                  <InlineLink\n                    target=\"_blank\"\n                    href=\"https://www.mapbox.com/help/how-access-tokens-work/\"\n                  >\n                    {' '}\n                    {intl.formatMessage({id: 'modal.addStyle.publishSubtitle6'})}\n                  </InlineLink>{' '}\n                  {intl.formatMessage({id: 'modal.addStyle.publishSubtitle7'})}\n                </div>\n                <InputLight\n                  type=\"text\"\n                  value={inputStyle.accessToken || ''}\n                  onChange={({target: {value}}) => this.props.inputMapStyle({accessToken: value})}\n                  placeholder={intl.formatMessage({id: 'modal.addStyle.exampleToken'})}\n                />\n              </StyledModalSection>\n\n              <StyledModalSection>\n                <div className=\"modal-section-title\">\n                  <FormattedMessage id={'modal.addStyle.namingTitle'} />\n                </div>\n                <InputLight\n                  type=\"text\"\n                  value={inputStyle.label || ''}\n                  onChange={({target: {value}}) => this.props.inputMapStyle({label: value})}\n                />\n              </StyledModalSection>\n            </StyledModalVerticalPanel>\n            <PreviewMap>\n              <div\n                className={classnames('preview-title', {\n                  error: inputStyle.error\n                })}\n              >\n                {inputStyle.error\n                  ? ErrorMsg.styleError\n                  : (inputStyle.style && inputStyle.style.name) || ''}\n              </div>\n              <StyledPreviewImage className=\"preview-image\">\n                {!inputStyle.isValid ? (\n                  <div className=\"preview-image-spinner\" />\n                ) : (\n                  <StyledMapContainer>\n                    <MapboxGLMap\n                      {...mapProps}\n                      ref={el => {\n                        this.mapRef = el;\n                      }}\n                      key={this.state.reRenderKey}\n                      width={MapW}\n                      height={MapH}\n                      mapStyle={inputStyle.url === null ? undefined : inputStyle.url}\n                    />\n                  </StyledMapContainer>\n                )}\n              </StyledPreviewImage>\n            </PreviewMap>\n          </StyledModalContent>\n        </div>\n      );\n    }\n  }\n\n  return injectIntl(polyfill(AddMapStyleModal));\n}\n\nexport default AddMapStyleModalFactory;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBAA,OAAA;AACA,IAAAC,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,gBAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,aAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,uBAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,UAAA,GAAAL,sBAAA,CAAAC,OAAA;AAOA,IAAAK,2BAAA,GAAAN,sBAAA,CAAAC,OAAA;AAGA,IAAAM,gBAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,gBAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,uBAAA,GAAAT,sBAAA,CAAAC,OAAA;;;;;;AAIA,IAAMS,kBAAN,GAAAT,OAAA;AAEA,IAAMU,OAAA,GAAQV,OAAG;AAAA,IAAjBW,MAAA,GAAAX,OAAA;AAKA,IAAMY,UAAU,GAAGZ,OAAA;AAeD,IAGda,aAAM,GAAAb,OAlBM;AA8BhB,IAAMc,eAAA,EAAAC,gBAAqB,EAAAC,gBAAO,EAAVC,gBAAA,EAAAC,gBAAA;AACH,SAITC,OALZC,CAAAC,MAAA,EAAAC,cAAA;EAAA,IAAAC,IAAA,GAAAC,MAAA,CAAAD,IAAA,CAAAF,MAAA;EAAA,IAAAG,MAAA,CAAAC,qBAAA;IAAA,IAAAC,OAAA,GAAAF,MAAA,CAAAC,qBAAA,CAAAJ,MAAA;IAAA,IAAAC,cAAA,EAAAI,OAAA,GAAAA,OAAA,CAAAC,MAAA,WAAAC,GAAA;MAAA,OAAAJ,MAAA,CAAAK,wBAAA,CAAAR,MAAA,EAAAO,GAAA,EAAAE,UAAA;IAAA;IAAAP,IAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,IAAA,EAAAG,OAAA;EAAA;EAAA,OAAAH,IAAA;AAAA;AAqBA,SAAMU,aAAaA,CAAAC,MAAA;EAAA,SAAAC,CAAA,GAAO,CAAV,EAAAA,CAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAF,CAAA;IAAA,IAAAG,MAAA,GAAAF,SAAA,CAAAD,CAAA,YAAAC,SAAA,CAAAD,CAAA;IAAA,IAAAA,CAAA;MAAAhB,OAAA,CAAAK,MAAA,CAAAc,MAAA,SAAAC,OAAA,WAAAC,GAAA,EAAhB;QAAA,IAAAjC,gBAAA,aAAA2B,MAAA,EAAAM,GAAA,EAAAF,MAAA,CAAAE,GAAA;MAAA;IAAA,WAAAhB,MAAA,CAAAiB,yBAAA;MAAAjB,MAAA,CAAAkB,gBAAA,CAAAR,MAAA,EAAAV,MAAA,CAAAiB,yBAAA,CAAAH,MAAA;IAAA;MAAAnB,OAAA,CAAAK,MAAA,CAAAc,MAAA,GAAAC,OAAA,WAAAC,GAAA;QAAAhB,MAAA,CAAAmB,cAAA,CAAAT,MAAA,EAAAM,GAAA,EAAAhB,MAAA,CAAAK,wBAAA,CAAAS,MAAA,EAAAE,GAAA;MAAA;IAAA;EAAA;EAAA,OAAAN,MAAA;AAAA;AAkBA,SAASU,aAAAC,OAAA;EAAT,IAAmCC,yBAAA,GAAAC,yBAAA;EAAA,gBAAAC,qBAAA;IAAA,IAAAC,KAAA,OAAA3C,gBAAA,aAAAuC,OAAA;MAAAK,MAAA;IAAA,IAAAJ,yBAAA;MAAA,IAAAK,SAAA,OAAA7C,gBAAA,mBAAA8C,WAAA;MAAAF,MAAA,GAAAG,OAAA,CAAAC,SAAA,CAAAL,KAAA,EAAAb,SAAA,EAAAe,SAAA;IAAA;MAAAD,MAAA,GAAAD,KAAA,CAAAjB,KAAA,OAAAI,SAAA;IAAA;IAAA,WAAA/B,2BAAA,mBAAA6C,MAAA;EAAA;AAAA;AAAA,SAAAH,0BAAA;EAAA,WAAAM,OAAA,qBAAAA,OAAA,CAAAC,SAAA;EAAA,IAAAD,OAAA,CAAAC,SAAA,CAAAC,IAAA;EAAA,WAAAC,KAAA;EAAA;IAAAC,OAAA,CAAAC,SAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAP,OAAA,CAAAC,SAAA,CAAAG,OAAA;IAAA;EAAA,SAAAI,CAAA;IAAA;EAAA;AAAA;AAAA,IAAAzC,IAAA;;AAAA,IAAA0C,QAAA;EAAAC,UAAA;;;EAAA,OAAAC,KAAA,CAAAC,KAAA,CAAAC,UAAA;AAAA,GAAAxD,OAAA,CAAAyD,KAAA,CAAAC,QAAA,CAAArD,gBAAA,KAAAA,gBAAA,OAAAP,uBAAA,kDAAAE,OAAA,CAAAyD,KAAA,CAAAE,IAAA,CAAArD,gBAAA,KAAAA,gBAAA,OAAAR,uBAAA;;EAAA,OAAAwD,KAAA,CAAAC,KAAA,CAAAK,qBAAA;AAAA,GAAAC,IAAA,EAAAnD,IAAA;AAI7B,IAAAoD,UAAA,GAAAC,iBAAe,YAAAC,CAAA,CAAAxD,gBAAA,KAAAA,gBAAA,OAAAV,uBAAA;AAJc,SAAAmE,wBAAA;EAAA,IAAAC,gBAAA,0BAAAC,UAAA;IAAA,IAAAzE,UAAA,aAAAwE,gBAAA,EAAAC,UAAA;IA8CE,IAAAC,MAAA,GAAAlC,YAAD,CAAAgC,gBAAA;IAAA,SAA9BA,iBAAA;MACD,IA/C8BG,KAAA;MAkD7B,IAAA9E,gBAAW,aAAmB,MAAA2E,gBAAA;MAAA,KAA9B,IAAAI,IAAA,GAAA5C,SAAA,CAAAC,MAAA,EAAA4C,IAAA,OAAAC,KAAA,CAAAF,IAAA,GAAAG,IAAA,MAAAA,IAAA,GAAAH,IAAA,EAAAG,IAAA;QAlD6BF,IAAA,CAAAE,IAAA,IAAA/C,SAAA,CAAA+C,IAAA;MAAA;;MAAA,IAAA5E,gBAAA,iBAAAJ,uBAAA,aAAA4E,KAAA;QAAAK,WAAA;QAAAC,aA6B/B;MAAqB;;MACnB,IAAA9E,gBAAiB,UAAU,GAAK,IAAAJ,uBAAhC,aAAA4E,KAAA;;QACAA,KAAI,CAAAf,KAAO,CAAAsB,kBAAmB;UAC5BC,KAAK,EAAAA,KAAO;UAEZC,KAAI,EAAG;QACL;;MACA,IAAAjF,gBAAK,UAAiB,KAAtB,EAAAJ,uBAAA,aAAA4E,KAAA;QACDA,KAHD,CAAAf,KAAA,CAAAsB,kBAAA;UAKAE,KAAI,EAAG;QACL;MACD;MACF,OAAAT,KAAA;IACF;IA3C8B,IAAA7E,aAAA,aAAA0E,gBAAA;MAAApC,GAAA,sBAqDtB;MAAAiD,KAAA,WAAAC,mBAAA;;QAAA,IACAC,GAAA,OADA,CAAAC,MAAA,QACA,CAAAA,MAAA,CAAAC,MADA;QAAA,IACsBF,GAAA,SADtBG,IAAA,KAAAH,GAAA;UAAA,IACoC,CAAAG,IADpC,GAAAH,GAAA;UAGPA,GAAM,CAAAI,EAAA,2BAAuB;;YAG3BC,MAAA,CAAAC,gBAAA,CAFYV,KAAA;UAGZ;UACAI,GAAA,CAAAI,EAAA,sBAJY;YAKZC,MAAA,CAAAE,iBAAA;UALF;;MAQA;IACO;MAAL1D,GAAA;MAIaiD,KAAA,WAAUU,OAAA;QAAf,IAAAC,MAAA,OACE;QAAA,IAFJC,WAAA,GAIE,KAAArC,KAAA;UAAKsC,UAAU,GAAAD,WAAA,CAAAC,UAAA;UACZC,QAAK,GAAAF,WAAc,CAAAE,QAAA;UAAGC,YAAE,GAAAH,WAAA,CAAAG,YAAA;UAD3BC,IAAA,GAAAJ,WAEE,CAAAI,IAAA;QACE,IAAAC,oBADF,GAAAJ,UAAA,CAAAK,WAAA,SAAA3C,KAAA,CAAA0C,oBAAA;QAAA,IAIGE,QACI,GAAC3E,aAAc,CAAAA,aAAA,KAAAsE,QAAA;UAACC,YAAI,EAAAA,YAAA;UAL3BE,oBAOM,EAAAA,oBAAc;UAACG,qBAAI;UAT3BC,gBAUE,EAAAnG,MAAA,CAAAmG;QACE;QADF,oBAKQC,MAAL,CAAmB,WAAAC,aAAA;UAACC,SAAI;QAAL,CAAnB,EAfL,aAJFF,MAsBE,YAAAC,aAAA,CAAAvG,kBAAC,CAAAyG,kBAAD,qBAAAH,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAA0G,wBAAA,qBAAAJ,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAA2G,kBAAA,qBAAAL,MAAA,YAAAC,aAAA;UACEC,SAAK;QACL,gBAAOF,MAAW,CAAX,SAFT,EAAAC,aAAA,CAAAnG,aAAA,CAAAwG,gBAAA;UAGEC,EAAA;QAAU,kBAAAP,MAAE,UAAF,EAAAC,aAAA;UAAAC,SAAuB;QAA0B,GAAAR,IAAA,CAAAc,aAAK;UAAND,EAAA,EAAhD;QAAA,IAHZ,aAAAP,MAAA,YAAAC,aAAA,CAAAxC,UAAA;UAIEtC,MAAA,UAAY;UA1BhBsF,IADF;QAgCS,QAAAf,IAAS,CAACc,aAAA;UAAfD,EAAA;QACoB,KAAE,GAAE,EAAAb,IAAA,CAAAc,aAAA;UADxBD,EADF;QAIO,iBAAUP,MAAA,YAAAC,aAAA,CAAAxC,UAAA;UAAftC,MACQ;UAAesF,IAAI;QAAL,CAAnB,EADH,KAAAf,IAAA,CAAAc,aAEE;UAAYD,EAAA;QAAgB,MAAI,aAACP,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAAgH,UAAA;UAAjCC,IAAA;UAIqBjC,KAAI,EAAAa,UAAA,CAAAqB,GAAA;UAN3BC,QAAA,WAOEA,SAAAC,IAAA;YACE,IAAMpC,KAAC,GAAAoC,IADT,CAAA3F,MAAA,CAAAuD,KAAA;YAEE,OAAKW,MAAA,CAAApC,KAAA,CAAA8D,aAAA;cAFPH,GAKG,EAAAlC;YAAsB,EAAE;UAL3B,CAPF;UAcuBsC,WAAI;QAAL,CAAnB,CAdH,CAJF,eAqBEhB,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAA2G,kBAAA,qBAAAL,MAAA,YAAAC,aAAA;UAAKC,SAAS,EAAC;QAAf,GACG,aAAKF,MAAc,YAAAC,aAAA,CAAAnG,aAAA,CAAAwG,gBAAA;UAACC,EAAE,EAAE;QAAL,CAAnB,CADH,gBAEEP,MAAA,YAAAC,aAAC;UACCC,SAAO;QACP,GAAAR,IAAI,CAACc,aAAA;UAFPD,EAIG,EAJH;QAKuB,IAAE,aAAEP,MAAA,YAAAC,aAAA,CAAAxC,UAAA;UAL3BtC,MAFF,EASG,QAAK;UAAesF,IAAI;QAAL,CAAnB,EA9BL,gBAgCE,KAAAf,IAAA,CAAAc,aAAA;UACED,EAAA,EAAI;QACJ,iBAAOP,MAAW,UAAX,EAA0BC,aAFnC,CAAAxC,UAAA;UAGEtC,MAAA,EAAQ,QAAE;UAAAsF,IAAA,EAAW;QAAX,QAAAf,IAAuB,CAAAc,aAAW;UAAeD,EAAA;QAAD,KAAzB,GAAvB,EAAAb,IAAA,CAAAc,aAAA;UAAAD,EAHZ;QAIE,kBAAaP,MAAK,UAAc,EAAAC,aAAA;UAACC,SAAI;QAAL,GAAnBR,IAAA,CAAAc,aAAA;UApCjBD,EA/BF;QAwES,iBAAUP,MAAA,YAAAC,aAAA,CAAAxC,UAAA;UAAftC,MAAA,UACE;UAAkBsF,IAAI;QAAtB,GAFJ,KAAAf,IAAA,CAAAc,aAIE;UACED,EAAA,EAAI;QACJ,QAAK,EAAEb,IAAA,CAAAc,aAAA,CAAoB;UAC3BD,EAAA;QAAU,kBAAAP,MAAE,UAAF,EAAAC,aAAA,CAAAvG,kBAAA,CAAAgH,UAAA;UAAAC,IAAA,QAAuB;UAA0BjC,KAAA,EAAAa,UAAO,CAAAK,WAAA;UAARiB,QAAhD,WAAAA,SAAAI,KAAA;YAAA,IAAAvC,KAAA,GAAAuC,KAAA,CAAA9F,MAAA,CAAAuD,KAAA;YA/ElB,OAAAW,MAAA,CAAApC,KAmFE,CAAA8D,aAAA;cAEInB,WAAW,EAAAlB;YACT;UADqC,CAA5B;UADbsC,WAKa,EAACtB,IAAX,CAAAc,aACY;YAGKD,EAAA;UAApB,CACG;QACM,kBAAUP,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAA2G,kBAAA,qBAAAL,MAAA,YAAAC,aAAA;UADhBC,SAAA;QAMK,gBAAKF,MAAE,UAAI,EAAAC,aAAA,CAAAnG,aAAA,CAAAwG,gBAAA;UACTC,EAAA;QACD,GAJH,eAAAP,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAAgH,UAAA;UAKEC,IAAG,EAAE,MAAK;UACVjC,KAAK,EAAEa,UANT,CAAA2B,KAAA;UAOEL,QAAQ,WAPVA,SAAAM,KAAA;YAQE,IAAAzC,KAAU,GAAAyC,KAAA,CAAUhG,MAAV,CAAAuD,KAAmB;YAbrC,OA/FRW,MAAA,CAAApC,KAAA,CAAA8D,aAAA;cAqHDG,KAAA,EAAAxC;YAtL8B;UAAA;QAAA,MAO/B,aAAAsB,MAAA,YAAAC,aAAuC,CAAvCmB,UAA8C,qBAAApB,MAAA,YAAAC,aAAA;UAC5CC,SACQ,MAAAmB,WACN,CAAK,SAAC,GAAW,eACjB;YAEA5C,KAAA,EAAAc,UAAA,CAAAd;UACA;QACA,GAAAc,UAAA,CAAAd,KAAA,GAAA1B,QAAA,CAAAC,UAAA,GAAAuC,UAAA,CAAAf,KAAA,IAAAe,UAAA,CAAAf,KAAA,CAAA8C,IAAA,sBAAAtB,MAAA,YAAAC,aAAA,CAAAsB,kBAAA;UAEArB,SAAO;QACL,IAAAX,UAAA,CAAWiC,OAAO,GAAC,aADdxB,MAAA,YAAAC,aAAA;UAELC,SAAA;QAFK,KAAP,aAAAF,MAAA,YAAAC,aAAA,CAAAvG,kBAAA,CAAA+H,kBAAA,qBAAAzB,MAAA,YAAAC,aAAA,CAAAyB,WAAA,iBAAA3I,SAAA,iBAAA8G,QAAA;UAID8B,GAAA,WAAAA,IAAAC,EAAA;;UAED;UACDnG,GAAA,OAAAoG,KAAA,CAAAxD,WAAA;UAxB8ByD,KAAA,EAAAtE,IAAA;UAAAuE,MAAA,EAAA1H,IAAA;UACF2H,QAAA,EADEzC,UAAA,CAAAqB,GAAA,YAAAqB,SAAA,GAAA1C,UAAA,CAAAqB;;MAyLjC;IACD;;sBAEcsB,wB"},"metadata":{},"sourceType":"script","externalDependencies":[]}