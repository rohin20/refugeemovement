{"ast":null,"code":"import _objectSpread from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _defineProperty2 from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _classCallCheck from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { default as LayersPass } from './layers-pass';\nimport { Framebuffer, Texture2D, Renderbuffer, withParameters, cssToDeviceRatio } from '@luma.gl/core';\nvar ShadowPass = /*#__PURE__*/function (_LayersPass) {\n  _inherits(ShadowPass, _LayersPass);\n  var _super = _createSuper(ShadowPass);\n  function ShadowPass(gl, props) {\n    var _parameters, _attachments;\n    var _this;\n    _classCallCheck(this, ShadowPass);\n    _this = _super.call(this, gl, props);\n    _defineProperty(_assertThisInitialized(_this), \"shadowMap\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"depthBuffer\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"fbo\", void 0);\n    _this.shadowMap = new Texture2D(gl, {\n      width: 1,\n      height: 1,\n      parameters: (_parameters = {}, _defineProperty2(_parameters, 10241, 9729), _defineProperty2(_parameters, 10240, 9729), _defineProperty2(_parameters, 10242, 33071), _defineProperty2(_parameters, 10243, 33071), _parameters)\n    });\n    _this.depthBuffer = new Renderbuffer(gl, {\n      format: 33189,\n      width: 1,\n      height: 1\n    });\n    _this.fbo = new Framebuffer(gl, {\n      id: 'shadowmap',\n      width: 1,\n      height: 1,\n      attachments: (_attachments = {}, _defineProperty2(_attachments, 36064, _this.shadowMap), _defineProperty2(_attachments, 36096, _this.depthBuffer), _attachments)\n    });\n    return _this;\n  }\n  _createClass(ShadowPass, [{\n    key: \"render\",\n    value: function render(params) {\n      var _this2 = this;\n      var target = this.fbo;\n      withParameters(this.gl, {\n        depthRange: [0, 1],\n        depthTest: true,\n        blend: false,\n        clearColor: [1, 1, 1, 1]\n      }, function () {\n        var viewport = params.viewports[0];\n        var pixelRatio = cssToDeviceRatio(_this2.gl);\n        var width = viewport.width * pixelRatio;\n        var height = viewport.height * pixelRatio;\n        if (width !== target.width || height !== target.height) {\n          target.resize({\n            width: width,\n            height: height\n          });\n        }\n        _get(_getPrototypeOf(ShadowPass.prototype), \"render\", _this2).call(_this2, _objectSpread(_objectSpread({}, params), {}, {\n          target: target,\n          pass: 'shadow'\n        }));\n      });\n    }\n  }, {\n    key: \"shouldDrawLayer\",\n    value: function shouldDrawLayer(layer) {\n      return layer.props.shadowEnabled !== false;\n    }\n  }, {\n    key: \"getModuleParameters\",\n    value: function getModuleParameters() {\n      return {\n        drawToShadowMap: true\n      };\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      if (this.fbo) {\n        this.fbo.delete();\n        this.fbo = null;\n      }\n      if (this.shadowMap) {\n        this.shadowMap.delete();\n        this.shadowMap = null;\n      }\n      if (this.depthBuffer) {\n        this.depthBuffer.delete();\n        this.depthBuffer = null;\n      }\n    }\n  }]);\n  return ShadowPass;\n}(LayersPass);\nexport { ShadowPass as default };","map":{"version":3,"names":["default","LayersPass","Framebuffer","Texture2D","Renderbuffer","withParameters","cssToDeviceRatio","ShadowPass","_LayersPass","_inherits","_super","_createSuper","gl","props","_parameters","_attachments","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","shadowMap","width","height","parameters","_defineProperty2","depthBuffer","format","fbo","id","attachments","_createClass","key","value","render","params","_this2","target","depthRange","depthTest","blend","clearColor","viewport","viewports","pixelRatio","resize","_get","_getPrototypeOf","prototype","_objectSpread","pass","shouldDrawLayer","layer","shadowEnabled","getModuleParameters","drawToShadowMap","_delete","delete"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@deck.gl/core/src/passes/shadow-pass.ts"],"sourcesContent":["import {default as LayersPass} from './layers-pass';\nimport {\n  Framebuffer,\n  Texture2D,\n  Renderbuffer,\n  withParameters,\n  cssToDeviceRatio\n} from '@luma.gl/core';\n\nexport default class ShadowPass extends LayersPass {\n  shadowMap: Texture2D;\n  depthBuffer: Renderbuffer;\n  fbo: Framebuffer;\n\n  constructor(\n    gl: WebGLRenderingContext,\n    props?: {\n      id;\n    }\n  ) {\n    super(gl, props);\n\n    // The shadowMap texture\n    this.shadowMap = new Texture2D(gl, {\n      width: 1,\n      height: 1,\n      parameters: {\n        [gl.TEXTURE_MIN_FILTER]: gl.LINEAR,\n        [gl.TEXTURE_MAG_FILTER]: gl.LINEAR,\n        [gl.TEXTURE_WRAP_S]: gl.CLAMP_TO_EDGE,\n        [gl.TEXTURE_WRAP_T]: gl.CLAMP_TO_EDGE\n      }\n    });\n\n    this.depthBuffer = new Renderbuffer(gl, {\n      format: gl.DEPTH_COMPONENT16,\n      width: 1,\n      height: 1\n    });\n\n    this.fbo = new Framebuffer(gl, {\n      id: 'shadowmap',\n      width: 1,\n      height: 1,\n      attachments: {\n        [gl.COLOR_ATTACHMENT0]: this.shadowMap,\n        // Depth attachment has to be specified for depth test to work\n        [gl.DEPTH_ATTACHMENT]: this.depthBuffer\n      }\n    });\n  }\n\n  render(params) {\n    const target = this.fbo;\n\n    withParameters(\n      this.gl,\n      {\n        depthRange: [0, 1],\n        depthTest: true,\n        blend: false,\n        clearColor: [1, 1, 1, 1]\n      },\n      () => {\n        const viewport = params.viewports[0];\n        const pixelRatio = cssToDeviceRatio(this.gl);\n        const width = viewport.width * pixelRatio;\n        const height = viewport.height * pixelRatio;\n        if (width !== target.width || height !== target.height) {\n          target.resize({width, height});\n        }\n\n        super.render({...params, target, pass: 'shadow'});\n      }\n    );\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.shadowEnabled !== false;\n  }\n\n  getModuleParameters() {\n    return {\n      drawToShadowMap: true\n    };\n  }\n\n  delete() {\n    if (this.fbo) {\n      this.fbo.delete();\n      this.fbo = null;\n    }\n\n    if (this.shadowMap) {\n      this.shadowMap.delete();\n      this.shadowMap = null;\n    }\n\n    if (this.depthBuffer) {\n      this.depthBuffer.delete();\n      this.depthBuffer = null;\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}