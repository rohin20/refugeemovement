{"ast":null,"code":"// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _localization = require(\"@kepler.gl/localization\");\nvar _react2 = _interopRequireDefault(require(\"@tippyjs/react\"));\nvar _icons = require(\"../../common/icons\");\nvar _styledComponents2 = require(\"../../common/styled-components\");\nvar _ = require(\"../..\");\nvar _typeahead = _interopRequireDefault(require(\"../../common/item-selector/typeahead\"));\nvar _accessor = _interopRequireDefault(require(\"../../common/item-selector/accessor\"));\nvar _templateObject, _templateObject2, _templateObject3;\nvar DropdownContainer = _styledComponents[\"default\"].div.attrs({\n  className: 'add-layer-menu-dropdown'\n})(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  .list-selector {\\n    border-top: 1px solid \", \";\\n    width: 100%;\\n    /* disable scrolling, currently set to 280px internally */\\n    max-height: unset;\\n  }\\n\\n  .list__item > div {\\n    display: flex;\\n    flex-direction: row;\\n    justify-content: flex-start;\\n    line-height: 18px;\\n    padding: 0;\\n\\n    svg {\\n      margin-right: 10px;\\n    }\\n  }\\n\"])), function (props) {\n  return props.theme.secondaryInputBorderColor;\n});\nvar AddLayerMenu = _styledComponents[\"default\"].div.attrs({\n  className: 'add-layer-menu'\n})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  flex-direction: column;\\n  min-width: 240px;\\n  max-width: 240px;\\n  position: absolute;\\n  top: 100%;\\n  left: -53px;\\n  z-index: 5;\\n\"])));\nvar ListItemWrapper = _styledComponents[\"default\"].div.attrs({\n  className: 'add-layer-menu-list-item-wrapper'\n})(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  display: flex;\\n  color: \", \";\\n  font-size: 11px;\\n  letter-spacing: 0.2px;\\n  overflow: auto;\\n\\n  .dataset-color {\\n    flex-shrink: 0;\\n    margin-top: 3px;\\n  }\\n\\n  .dataset-name {\\n    white-space: nowrap;\\n    overflow: hidden;\\n    text-overflow: ellipsis;\\n  }\\n\"])), function (props) {\n  return props.theme.textColor;\n});\nvar TYPEAHEAD_CLASS = 'typeahead';\nvar TYPEAHEAD_INPUT_CLASS = 'typeahead__input';\nfunction AddLayerButtonFactory() {\n  var ListItem = function ListItem(_ref) {\n    var value = _ref.value;\n    return /*#__PURE__*/_react[\"default\"].createElement(ListItemWrapper, null, /*#__PURE__*/_react[\"default\"].createElement(_.DatasetSquare, {\n      className: \"dataset-color\",\n      backgroundColor: value.color\n    }), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n      className: \"dataset-name\",\n      title: value.label\n    }, value.label));\n  };\n  var AddLayerButton = function AddLayerButton(props) {\n    var datasets = props.datasets,\n      onOptionSelected = props.onOptionSelected,\n      typeaheadPlaceholder = props.typeaheadPlaceholder,\n      intl = props.intl;\n    var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      showAddLayerDropdown = _useState2[0],\n      setShowAddLayerDropdown = _useState2[1];\n    var toggleAddLayerDropdown = (0, _react.useCallback)(function () {\n      setShowAddLayerDropdown(!showAddLayerDropdown);\n    }, [showAddLayerDropdown, setShowAddLayerDropdown]);\n    var _onBlur = (0, _react.useCallback)(function () {\n      setShowAddLayerDropdown(false);\n    }, []);\n    var toggleSelectedOption = (0, _react.useCallback)(function (option) {\n      onOptionSelected(option.value);\n      _onBlur();\n    }, [onOptionSelected, _onBlur]);\n    var onButtonBlur = (0, _react.useCallback)(function (event) {\n      if ([TYPEAHEAD_CLASS, TYPEAHEAD_INPUT_CLASS].every(function (cls) {\n        var _event$relatedTarget;\n        return !(event !== null && event !== void 0 && (_event$relatedTarget = event.relatedTarget) !== null && _event$relatedTarget !== void 0 && _event$relatedTarget.classList.contains(cls));\n      })) {\n        _onBlur();\n      }\n    }, [_onBlur]);\n    var onSearchBlur = (0, _react.useCallback)(function () {\n      _onBlur();\n    }, [_onBlur]);\n    var options = (0, _react.useMemo)(function () {\n      return Object.values(datasets).map(function (ds) {\n        return {\n          label: ds.label,\n          value: ds.id,\n          color: ds.color\n        };\n      });\n    }, [datasets]);\n    return /*#__PURE__*/_react[\"default\"].createElement(_react2[\"default\"], {\n      visible: showAddLayerDropdown,\n      arrow: false,\n      interactive: true,\n      placement: \"bottom\",\n      appendTo: \"parent\",\n      duration: 0,\n      content: /*#__PURE__*/_react[\"default\"].createElement(AddLayerMenu, null, /*#__PURE__*/_react[\"default\"].createElement(DropdownContainer, null, /*#__PURE__*/_react[\"default\"].createElement(_typeahead[\"default\"], {\n        onBlur: onSearchBlur,\n        className: TYPEAHEAD_CLASS,\n        customClasses: {\n          results: 'list-selector',\n          input: TYPEAHEAD_INPUT_CLASS,\n          listItem: 'list__item'\n        },\n        placeholder: typeaheadPlaceholder || intl ? intl.formatMessage({\n          id: 'placeholder.search'\n        }) : 'Search',\n        selectedItems: null,\n        options: options,\n        displayOption: _accessor[\"default\"].generateOptionToStringFor('label'),\n        filterOption: 'label',\n        searchable: true,\n        onOptionSelected: toggleSelectedOption,\n        customListItemComponent: ListItem\n      })))\n    }, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents2.Button, {\n      tabIndex: -1,\n      onBlur: onButtonBlur,\n      className: \"add-layer-button\",\n      width: \"105px\",\n      onClick: toggleAddLayerDropdown\n    }, /*#__PURE__*/_react[\"default\"].createElement(_icons.Add, {\n      height: \"12px\"\n    }), /*#__PURE__*/_react[\"default\"].createElement(_localization.FormattedMessage, {\n      id: 'layerManager.addLayer'\n    })));\n  };\n  return AddLayerButton;\n}\nvar _default = AddLayerButtonFactory;\nexports[\"default\"] = _default;","map":{"version":3,"names":["value","exports","_slicedToArray2","_interopRequireDefault","require","_react","_interopRequireWildcard","_styledComponents","_localization","_react2","_icons","_styledComponents2","_","_typeahead","_accessor","DropdownContainer","div","attrs","className","_templateObject","_taggedTemplateLiteral2","props","theme","secondaryInputBorderColor","AddLayerMenu","_templateObject2","_templateObject3","textColor","TYPEAHEAD_INPUT_CLASS","AddLayerButtonFactory","showAddLayerDropdown","ListItem","setShowAddLayerDropdown","_ref","createElement","ListItemWrapper","DatasetSquare","backgroundColor","color","title","label","AddLayerButton","onOptionSelected","typeaheadPlaceholder","intl","_useState","useState","_useState2","toggleAddLayerDropdown","useCallback","_onBlur","toggleSelectedOption","option","onButtonBlur","event","TYPEAHEAD_CLASS","every","cls","_event$relatedTarget","relatedTarget","classList","contains","onSearchBlur","options","useMemo","Object","values","datasets","map","ds","id","visible","arrow","interactive","placement","appendTo","duration","content","onBlur","customClasses","results","input","listItem","placeholder","formatMessage","displayOption","generateOptionToStringFor"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@kepler.gl/components/src/side-panel/layer-panel/add-layer-button.tsx"],"sourcesContent":["// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {useCallback, useMemo, useState} from 'react';\nimport styled from 'styled-components';\nimport {FormattedMessage} from '@kepler.gl/localization';\nimport {WrappedComponentProps} from 'react-intl';\n\nimport Tippy from '@tippyjs/react';\nimport {Add} from '../../common/icons';\nimport {Button} from '../../common/styled-components';\nimport {DatasetSquare} from '../..';\nimport Typeahead from '../../common/item-selector/typeahead';\nimport Accessor from '../../common/item-selector/accessor';\nimport {Datasets} from '@kepler.gl/table';\nimport {RGBColor} from '@kepler.gl/types';\n\ntype AddLayerButtonProps = {\n  datasets: Datasets;\n  onOptionSelected: (opt: string) => void;\n  typeaheadPlaceholder?: string;\n} & WrappedComponentProps;\n\nconst DropdownContainer = styled.div.attrs({\n  className: 'add-layer-menu-dropdown'\n})`\n  .list-selector {\n    border-top: 1px solid ${props => props.theme.secondaryInputBorderColor};\n    width: 100%;\n    /* disable scrolling, currently set to 280px internally */\n    max-height: unset;\n  }\n\n  .list__item > div {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    line-height: 18px;\n    padding: 0;\n\n    svg {\n      margin-right: 10px;\n    }\n  }\n`;\n\nconst AddLayerMenu = styled.div.attrs({\n  className: 'add-layer-menu'\n})`\n  display: flex;\n  flex-direction: column;\n  min-width: 240px;\n  max-width: 240px;\n  position: absolute;\n  top: 100%;\n  left: -53px;\n  z-index: 5;\n`;\n\nconst ListItemWrapper = styled.div.attrs({\n  className: 'add-layer-menu-list-item-wrapper'\n})`\n  display: flex;\n  color: ${props => props.theme.textColor};\n  font-size: 11px;\n  letter-spacing: 0.2px;\n  overflow: auto;\n\n  .dataset-color {\n    flex-shrink: 0;\n    margin-top: 3px;\n  }\n\n  .dataset-name {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\n\nconst TYPEAHEAD_CLASS = 'typeahead';\nconst TYPEAHEAD_INPUT_CLASS = 'typeahead__input';\n\nfunction AddLayerButtonFactory() {\n  const ListItem = ({value}) => (\n    <ListItemWrapper>\n      <DatasetSquare className=\"dataset-color\" backgroundColor={value.color} />\n      <div className=\"dataset-name\" title={value.label}>\n        {value.label}\n      </div>\n    </ListItemWrapper>\n  );\n\n  const AddLayerButton: React.FC<AddLayerButtonProps> = props => {\n    const {datasets, onOptionSelected, typeaheadPlaceholder, intl} = props;\n    const [showAddLayerDropdown, setShowAddLayerDropdown] = useState(false);\n\n    const toggleAddLayerDropdown = useCallback(() => {\n      setShowAddLayerDropdown(!showAddLayerDropdown);\n    }, [showAddLayerDropdown, setShowAddLayerDropdown]);\n\n    const _onBlur = useCallback(() => {\n      setShowAddLayerDropdown(false);\n    }, []);\n\n    const toggleSelectedOption = useCallback(\n      (option: {label: string; value: string; color: RGBColor}) => {\n        onOptionSelected(option.value);\n        _onBlur();\n      },\n      [onOptionSelected, _onBlur]\n    );\n\n    const onButtonBlur = useCallback(\n      event => {\n        if (\n          [TYPEAHEAD_CLASS, TYPEAHEAD_INPUT_CLASS].every(\n            cls => !event?.relatedTarget?.classList.contains(cls)\n          )\n        ) {\n          _onBlur();\n        }\n      },\n      [_onBlur]\n    );\n\n    const onSearchBlur = useCallback(() => {\n      _onBlur();\n    }, [_onBlur]);\n\n    const options = useMemo(() => {\n      return Object.values(datasets).map(ds => ({\n        label: ds.label,\n        value: ds.id,\n        color: ds.color\n      }));\n    }, [datasets]);\n\n    return (\n      <Tippy\n        visible={showAddLayerDropdown}\n        arrow={false}\n        interactive\n        placement=\"bottom\"\n        appendTo=\"parent\"\n        duration={0}\n        content={\n          <AddLayerMenu>\n            <DropdownContainer>\n              <Typeahead\n                onBlur={onSearchBlur}\n                className={TYPEAHEAD_CLASS}\n                customClasses={{\n                  results: 'list-selector',\n                  input: TYPEAHEAD_INPUT_CLASS,\n                  listItem: 'list__item'\n                }}\n                placeholder={\n                  typeaheadPlaceholder || intl\n                    ? intl.formatMessage({id: 'placeholder.search'})\n                    : 'Search'\n                }\n                selectedItems={null}\n                options={options}\n                displayOption={Accessor.generateOptionToStringFor('label')}\n                filterOption={'label'}\n                searchable\n                onOptionSelected={toggleSelectedOption}\n                customListItemComponent={ListItem}\n              />\n            </DropdownContainer>\n          </AddLayerMenu>\n        }\n      >\n        <Button\n          tabIndex={-1}\n          onBlur={onButtonBlur}\n          className=\"add-layer-button\"\n          width=\"105px\"\n          onClick={toggleAddLayerDropdown}\n        >\n          <Add height=\"12px\" />\n          <FormattedMessage id={'layerManager.addLayer'} />\n        </Button>\n      </Tippy>\n    );\n  };\n\n  return AddLayerButton;\n}\n\nexport default AddLayerButtonFactory;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}