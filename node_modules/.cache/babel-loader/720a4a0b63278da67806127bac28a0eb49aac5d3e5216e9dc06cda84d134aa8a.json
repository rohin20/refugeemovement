{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nvar DEFAULT_OPTIONS = {\n  batchSize: 'auto',\n  convertToObject: true,\n  optimizeMemoryUsage: false\n};\nvar RowTableBatch = function () {\n  function RowTableBatch(schema) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _classCallCheck(this, RowTableBatch);\n    options = _objectSpread(_objectSpread({}, DEFAULT_OPTIONS), options);\n    this.schema = schema;\n    this.batchSize = options.batchSize;\n    this.convertToObject = options.convertToObject;\n    this.optimizeMemoryUsage = options.optimizeMemoryUsage;\n    this.rows = null;\n    this.length = 0;\n    this.isChunkComplete = false;\n    this.cursor = 0;\n    if (!Array.isArray(schema)) {\n      this._headers = [];\n      for (var key in schema) {\n        this._headers[schema[key].index] = schema[key].name;\n      }\n    }\n  }\n  _createClass(RowTableBatch, [{\n    key: \"addRow\",\n    value: function addRow(row) {\n      var cursor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      if (!this.rows) {\n        this.rows = new Array(this.batchSize);\n        this.length = 0;\n      }\n      if (Number.isFinite(cursor)) {\n        this.cursor = cursor;\n      }\n      var convertToObject = this.convertToObject && this.schema;\n      this.rows[this.length] = convertToObject ? convertRowToObject(row, this._headers) : row;\n      if (this.optimizeMemoryUsage) {\n        this.rows[this.length] = JSON.parse(JSON.stringify(this.rows[this.length]));\n      }\n      this.length++;\n    }\n  }, {\n    key: \"chunkComplete\",\n    value: function chunkComplete() {\n      this.isChunkComplete = true;\n    }\n  }, {\n    key: \"isFull\",\n    value: function isFull() {\n      if (this.batchSize === 'auto') {\n        return this.isChunkComplete && this.length > 0;\n      }\n      return this.rows && this.length >= this.batchSize;\n    }\n  }, {\n    key: \"getBatch\",\n    value: function getBatch() {\n      if (this.rows) {\n        var rows = this.rows.slice(0, this.length);\n        this.rows = null;\n        this.isChunkComplete = false;\n        return {\n          data: rows,\n          schema: this.schema,\n          length: rows.length,\n          cursor: this.cursor\n        };\n      }\n      return null;\n    }\n  }]);\n  return RowTableBatch;\n}();\nexport { RowTableBatch as default };\nfunction convertRowToObject(row, headers) {\n  if (!row) {\n    throw new Error('null row');\n  }\n  if (!Array.isArray(row)) {\n    return row;\n  }\n  if (!headers) {\n    return row;\n  }\n  var result = {};\n  for (var i = 0; i < headers.length; i++) {\n    result[headers[i]] = row[i];\n  }\n  return result;\n}","map":{"version":3,"names":["DEFAULT_OPTIONS","batchSize","convertToObject","optimizeMemoryUsage","RowTableBatch","schema","options","arguments","length","undefined","_classCallCheck","_objectSpread","rows","isChunkComplete","cursor","Array","isArray","_headers","key","index","name","row","Number","isFinite","convertRowToObject","JSON","parse","stringify","slice","data","headers","Error","result","i"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@loaders.gl/tables/src/lib/table/row-table-batch.js"],"sourcesContent":["const DEFAULT_OPTIONS = {\n  batchSize: 'auto',\n  convertToObject: true,\n  // optimizes memory usage but increases parsing time.\n  optimizeMemoryUsage: false\n};\n\nexport default class RowTableBatch {\n  constructor(schema, options = {}) {\n    options = {...DEFAULT_OPTIONS, ...options};\n\n    this.schema = schema;\n    this.batchSize = options.batchSize;\n    this.convertToObject = options.convertToObject;\n    this.optimizeMemoryUsage = options.optimizeMemoryUsage;\n\n    this.rows = null;\n    this.length = 0;\n    this.isChunkComplete = false;\n    this.cursor = 0;\n\n    // schema is an array if there're no headers\n    // object if there are headers\n    if (!Array.isArray(schema)) {\n      this._headers = [];\n      for (const key in schema) {\n        this._headers[schema[key].index] = schema[key].name;\n      }\n    }\n  }\n\n  addRow(row, cursor = null) {\n    if (!this.rows) {\n      this.rows = new Array(this.batchSize);\n      this.length = 0;\n    }\n    if (Number.isFinite(cursor)) {\n      this.cursor = cursor;\n    }\n\n    // We can only convert if we were given a schema\n    const convertToObject = this.convertToObject && this.schema;\n    this.rows[this.length] = convertToObject ? convertRowToObject(row, this._headers) : row;\n\n    if (this.optimizeMemoryUsage) {\n      // A workaround to allocate new strings and don't retain pointers to original strings.\n      // https://bugs.chromium.org/p/v8/issues/detail?id=2869\n      this.rows[this.length] = JSON.parse(JSON.stringify(this.rows[this.length]));\n    }\n\n    this.length++;\n  }\n\n  chunkComplete() {\n    this.isChunkComplete = true;\n  }\n\n  isFull() {\n    if (this.batchSize === 'auto') {\n      return this.isChunkComplete && this.length > 0;\n    }\n    return this.rows && this.length >= this.batchSize;\n  }\n\n  getBatch() {\n    if (this.rows) {\n      const rows = this.rows.slice(0, this.length);\n      this.rows = null;\n      this.isChunkComplete = false;\n      return {data: rows, schema: this.schema, length: rows.length, cursor: this.cursor};\n    }\n    return null;\n  }\n}\n\nfunction convertRowToObject(row, headers) {\n  if (!row) {\n    throw new Error('null row');\n  }\n  if (!Array.isArray(row)) {\n    return row;\n  }\n\n  if (!headers) {\n    return row;\n  }\n  const result = {};\n  for (let i = 0; i < headers.length; i++) {\n    result[headers[i]] = row[i];\n  }\n  return result;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}