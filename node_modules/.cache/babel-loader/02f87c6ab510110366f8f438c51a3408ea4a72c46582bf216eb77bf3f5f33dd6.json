{"ast":null,"code":"import _regeneratorRuntime from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { log } from '@deck.gl/core';\nvar Tile2DHeader = /*#__PURE__*/function () {\n  function Tile2DHeader(index) {\n    _classCallCheck(this, Tile2DHeader);\n    _defineProperty(this, \"index\", void 0);\n    _defineProperty(this, \"isVisible\", void 0);\n    _defineProperty(this, \"isSelected\", void 0);\n    _defineProperty(this, \"parent\", void 0);\n    _defineProperty(this, \"children\", void 0);\n    _defineProperty(this, \"content\", void 0);\n    _defineProperty(this, \"state\", void 0);\n    _defineProperty(this, \"layers\", void 0);\n    _defineProperty(this, \"id\", void 0);\n    _defineProperty(this, \"bbox\", void 0);\n    _defineProperty(this, \"zoom\", void 0);\n    _defineProperty(this, \"userData\", void 0);\n    _defineProperty(this, \"_abortController\", void 0);\n    _defineProperty(this, \"_loader\", void 0);\n    _defineProperty(this, \"_loaderId\", void 0);\n    _defineProperty(this, \"_isLoaded\", void 0);\n    _defineProperty(this, \"_isCancelled\", void 0);\n    _defineProperty(this, \"_needsReload\", void 0);\n    this.index = index;\n    this.isVisible = false;\n    this.isSelected = false;\n    this.parent = null;\n    this.children = [];\n    this.content = null;\n    this._loader = undefined;\n    this._abortController = null;\n    this._loaderId = 0;\n    this._isLoaded = false;\n    this._isCancelled = false;\n    this._needsReload = false;\n  }\n  _createClass(Tile2DHeader, [{\n    key: \"data\",\n    get: function get() {\n      var _this = this;\n      return this.isLoading && this._loader ? this._loader.then(function () {\n        return _this.data;\n      }) : this.content;\n    }\n  }, {\n    key: \"isLoaded\",\n    get: function get() {\n      return this._isLoaded && !this._needsReload;\n    }\n  }, {\n    key: \"isLoading\",\n    get: function get() {\n      return Boolean(this._loader) && !this._isCancelled;\n    }\n  }, {\n    key: \"needsReload\",\n    get: function get() {\n      return this._needsReload || this._isCancelled;\n    }\n  }, {\n    key: \"byteLength\",\n    get: function get() {\n      var result = this.content ? this.content.byteLength : 0;\n      if (!Number.isFinite(result)) {\n        log.error('byteLength not defined in tile data')();\n      }\n      return result;\n    }\n  }, {\n    key: \"_loadData\",\n    value: function () {\n      var _loadData2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n        var getData, requestScheduler, onLoad, onError, index, id, bbox, userData, zoom, loaderId, signal, requestToken, tileData, error;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              getData = _ref.getData, requestScheduler = _ref.requestScheduler, onLoad = _ref.onLoad, onError = _ref.onError;\n              index = this.index, id = this.id, bbox = this.bbox, userData = this.userData, zoom = this.zoom;\n              loaderId = this._loaderId;\n              this._abortController = new AbortController();\n              signal = this._abortController.signal;\n              _context.next = 7;\n              return requestScheduler.scheduleRequest(this, function (tile) {\n                return tile.isSelected ? 1 : -1;\n              });\n            case 7:\n              requestToken = _context.sent;\n              if (requestToken) {\n                _context.next = 11;\n                break;\n              }\n              this._isCancelled = true;\n              return _context.abrupt(\"return\");\n            case 11:\n              if (!this._isCancelled) {\n                _context.next = 14;\n                break;\n              }\n              requestToken.done();\n              return _context.abrupt(\"return\");\n            case 14:\n              tileData = null;\n              _context.prev = 15;\n              _context.next = 18;\n              return getData({\n                index: index,\n                id: id,\n                bbox: bbox,\n                userData: userData,\n                zoom: zoom,\n                signal: signal\n              });\n            case 18:\n              tileData = _context.sent;\n              _context.next = 24;\n              break;\n            case 21:\n              _context.prev = 21;\n              _context.t0 = _context[\"catch\"](15);\n              error = _context.t0 || true;\n            case 24:\n              _context.prev = 24;\n              requestToken.done();\n              return _context.finish(24);\n            case 27:\n              if (!(loaderId !== this._loaderId)) {\n                _context.next = 29;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 29:\n              this._loader = undefined;\n              this.content = tileData;\n              if (!(this._isCancelled && !tileData)) {\n                _context.next = 34;\n                break;\n              }\n              this._isLoaded = false;\n              return _context.abrupt(\"return\");\n            case 34:\n              this._isLoaded = true;\n              this._isCancelled = false;\n              if (error) {\n                onError(error, this);\n              } else {\n                onLoad(this);\n              }\n            case 37:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[15, 21, 24, 27]]);\n      }));\n      function _loadData(_x) {\n        return _loadData2.apply(this, arguments);\n      }\n      return _loadData;\n    }()\n  }, {\n    key: \"loadData\",\n    value: function loadData(opts) {\n      this._isLoaded = false;\n      this._isCancelled = false;\n      this._needsReload = false;\n      this._loaderId++;\n      this._loader = this._loadData(opts);\n      return this._loader;\n    }\n  }, {\n    key: \"setNeedsReload\",\n    value: function setNeedsReload() {\n      if (this.isLoading) {\n        this.abort();\n        this._loader = undefined;\n      }\n      this._needsReload = true;\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      var _this$_abortControlle;\n      if (this.isLoaded) {\n        return;\n      }\n      this._isCancelled = true;\n      (_this$_abortControlle = this._abortController) === null || _this$_abortControlle === void 0 ? void 0 : _this$_abortControlle.abort();\n    }\n  }]);\n  return Tile2DHeader;\n}();\nexport { Tile2DHeader as default };","map":{"version":3,"names":["log","Tile2DHeader","index","_classCallCheck","_defineProperty","isVisible","isSelected","parent","children","content","_loader","undefined","_abortController","_loaderId","_isLoaded","_isCancelled","_needsReload","_createClass","key","get","_this","isLoading","then","data","Boolean","result","byteLength","Number","isFinite","error","value","_loadData2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","getData","requestScheduler","onLoad","onError","id","bbox","userData","zoom","loaderId","signal","requestToken","tileData","wrap","_callee$","_context","prev","next","AbortController","scheduleRequest","tile","sent","abrupt","done","t0","finish","stop","_loadData","_x","apply","arguments","loadData","opts","setNeedsReload","abort","_this$_abortControlle","isLoaded","default"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@deck.gl/geo-layers/src/tile-layer/tile-2d-header.ts"],"sourcesContent":["/* eslint-env browser */\nimport {Layer, log} from '@deck.gl/core';\nimport {RequestScheduler} from '@loaders.gl/loader-utils';\nimport {TileBoundingBox, TileIndex, TileLoadProps} from './types';\n\nexport type TileLoadDataProps<DataT = any> = {\n  requestScheduler: RequestScheduler;\n  getData: (props: TileLoadProps) => Promise<DataT>;\n  onLoad: (tile: Tile2DHeader<DataT>) => void;\n  onError: (error: any, tile: Tile2DHeader<DataT>) => void;\n};\n\nexport default class Tile2DHeader<DataT = any> {\n  index: TileIndex;\n  isVisible: boolean;\n  isSelected: boolean;\n  parent: Tile2DHeader | null;\n  children: Tile2DHeader[] | null;\n  content: DataT | null;\n  state?: number;\n  layers?: Layer[] | null;\n\n  id!: string; // assigned _always_ with result of `getTileId`\n  bbox!: TileBoundingBox; // assigned _always_ with result of `getTileMetadata`\n  zoom!: number; // assigned _always_ with result of `getTileZoom`\n  userData?: Record<string, any>; // _may be_ assigned with result of `getTileMetadata`\n\n  private _abortController: AbortController | null;\n  private _loader: Promise<void> | undefined;\n  private _loaderId: number;\n  private _isLoaded: boolean;\n  private _isCancelled: boolean;\n  private _needsReload: boolean;\n\n  constructor(index: TileIndex) {\n    this.index = index;\n    this.isVisible = false;\n    this.isSelected = false;\n    this.parent = null;\n    this.children = [];\n\n    this.content = null;\n\n    this._loader = undefined;\n    this._abortController = null;\n    this._loaderId = 0;\n    this._isLoaded = false;\n    this._isCancelled = false;\n    this._needsReload = false;\n  }\n\n  get data(): Promise<DataT | null> | DataT | null {\n    return this.isLoading && this._loader ? this._loader.then(() => this.data) : this.content;\n  }\n\n  get isLoaded(): boolean {\n    return this._isLoaded && !this._needsReload;\n  }\n\n  get isLoading(): boolean {\n    return Boolean(this._loader) && !this._isCancelled;\n  }\n\n  get needsReload(): boolean {\n    return this._needsReload || this._isCancelled;\n  }\n\n  get byteLength(): number {\n    const result = this.content ? (this.content as any).byteLength : 0;\n    if (!Number.isFinite(result)) {\n      log.error('byteLength not defined in tile data')();\n    }\n    return result;\n  }\n\n  /* eslint-disable max-statements */\n  private async _loadData({\n    getData,\n    requestScheduler,\n    onLoad,\n    onError\n  }: TileLoadDataProps<DataT>): Promise<void> {\n    const {index, id, bbox, userData, zoom} = this;\n    const loaderId = this._loaderId;\n\n    this._abortController = new AbortController();\n    const {signal} = this._abortController;\n\n    // @ts-expect-error (2345) Argument of type '(tile: any) => 1 | -1' is not assignable ...\n    const requestToken = await requestScheduler.scheduleRequest(this, tile => {\n      return tile.isSelected ? 1 : -1;\n    });\n\n    if (!requestToken) {\n      this._isCancelled = true;\n      return;\n    }\n    // A tile can be cancelled while being scheduled\n    if (this._isCancelled) {\n      requestToken.done();\n      return;\n    }\n\n    let tileData: DataT | null = null;\n    let error;\n    try {\n      tileData = await getData({index, id, bbox, userData, zoom, signal});\n    } catch (err) {\n      error = err || true;\n    } finally {\n      requestToken.done();\n    }\n\n    // If loadData has been called with a newer version, discard the result from this operation\n    if (loaderId !== this._loaderId) {\n      return;\n    }\n    // Clear the `isLoading` flag\n    this._loader = undefined;\n    // Rewrite tile content with the result of getTileData if successful, or `null` in case of\n    // error or cancellation\n    this.content = tileData;\n    // If cancelled, do not invoke the callbacks\n    // Consider it loaded if we tried to cancel but `getTileData` still returned data\n    if (this._isCancelled && !tileData) {\n      this._isLoaded = false;\n      return;\n    }\n    this._isLoaded = true;\n    this._isCancelled = false;\n\n    if (error) {\n      onError(error, this);\n    } else {\n      onLoad(this);\n    }\n  }\n\n  loadData(opts: TileLoadDataProps): Promise<void> {\n    this._isLoaded = false;\n    this._isCancelled = false;\n    this._needsReload = false;\n    this._loaderId++;\n    this._loader = this._loadData(opts);\n    return this._loader;\n  }\n\n  setNeedsReload(): void {\n    if (this.isLoading) {\n      this.abort();\n      this._loader = undefined;\n    }\n    this._needsReload = true;\n  }\n\n  abort(): void {\n    if (this.isLoaded) {\n      return;\n    }\n\n    this._isCancelled = true;\n    this._abortController?.abort();\n  }\n}\n"],"mappings":";;;;;AACA,SAAeA,GAAf,QAAyB,eAAzB;AAAA,IAWqBC,YAAN;EAsBb,SAAAA,aAAYC,KAAD,EAAmB;IAAAC,eAAA,OAAAF,YAAA;IAAAG,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAC5B,KAAKF,KAAL,GAAaA,KAAb;IACA,KAAKG,SAAL,GAAiB,KAAjB;IACA,KAAKC,UAAL,GAAkB,KAAlB;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,QAAL,GAAgB,EAAhB;IAEA,KAAKC,OAAL,GAAe,IAAf;IAEA,KAAKC,OAAL,GAAeC,SAAf;IACA,KAAKC,gBAAL,GAAwB,IAAxB;IACA,KAAKC,SAAL,GAAiB,CAAjB;IACA,KAAKC,SAAL,GAAiB,KAAjB;IACA,KAAKC,YAAL,GAAoB,KAApB;IACA,KAAKC,YAAL,GAAoB,KAApB;EACD;EAAAC,YAAA,CAAAhB,YAAA;IAAAiB,GAAA;IAAAC,GAAA,EAEO,SAAAA,IAAA,EAAyC;MAAA,IAAAC,KAAA;MAC/C,OAAO,KAAKC,SAAL,IAAkB,KAAKX,OAAvB,GAAiC,KAAKA,OAAL,CAAaY,IAAb,CAAkB;QAAA,OAAMF,KAAA,CAAKG,IAA7B;MAAA,EAAjC,GAAsE,KAAKd,OAAlF;IACD;EAAA;IAAAS,GAAA;IAAAC,GAAA,EAEW,SAAAA,IAAA,EAAY;MACtB,OAAO,KAAKL,SAAL,IAAkB,CAAC,KAAKE,YAA/B;IACD;EAAA;IAAAE,GAAA;IAAAC,GAAA,EAEY,SAAAA,IAAA,EAAY;MACvB,OAAOK,OAAO,CAAC,KAAKd,OAAN,CAAP,IAAyB,CAAC,KAAKK,YAAtC;IACD;EAAA;IAAAG,GAAA;IAAAC,GAAA,EAEc,SAAAA,IAAA,EAAY;MACzB,OAAO,KAAKH,YAAL,IAAqB,KAAKD,YAAjC;IACD;EAAA;IAAAG,GAAA;IAAAC,GAAA,EAEa,SAAAA,IAAA,EAAW;MACvB,IAAMM,MAAM,GAAG,KAAKhB,OAAL,GAAgB,KAAKA,OAAN,CAAsBiB,UAArC,GAAkD,CAAjE;MACA,IAAI,CAACC,MAAM,CAACC,QAAP,CAAgBH,MAAhB,CAAL,EAA8B;QAC5BzB,GAAG,CAAC6B,KAAJ,CAAU,qCAAV;MACD;MACD,OAAOJ,MAAP;IACD;EAAA;IAAAP,GAAA;IAAAY,KAAA;MAAA,IAAAC,UAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAGsB,SAAAC,QAAAC,IAAA;QAAA,IAAAC,OAAA,EAAAC,gBAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAtC,KAAA,EAAAuC,EAAA,EAAAC,IAAA,EAAAC,QAAA,EAAAC,IAAA,EAAAC,QAAA,EAAAC,MAAA,EAAAC,YAAA,EAAAC,QAAA,EAAAnB,KAAA;QAAA,OAAAI,mBAAA,GAAAgB,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACrBhB,OADsB,GAAAD,IAAA,CACtBC,OADsB,EAEtBC,gBAFsB,GAAAF,IAAA,CAEtBE,gBAFsB,EAGtBC,MAHsB,GAAAH,IAAA,CAGtBG,MAHsB,EAItBC,OAAA,GAAAJ,IAAA,CAAAI,OAAA;cAEOtC,KAAD,GAAoC,IAA1C,CAAOA,KAAD,EAAQuC,EAAR,GAAoC,IAA1C,CAAcA,EAAR,EAAYC,IAAZ,GAAoC,IAA1C,CAAkBA,IAAZ,EAAkBC,QAAlB,GAAoC,IAA1C,CAAwBA,QAAlB,EAA4BC,IAAA,GAAQ,IAA1C,CAAkCA,IAAA;cAC5BC,QAAQ,GAAG,KAAKhC,SAAtB;cAEA,KAAKD,gBAAL,GAAwB,IAAI0C,eAAJ,EAAxB;cACOR,MAAA,GAAU,KAAKlC,gBAAtB,CAAOkC,MAAA;cAAAK,QAAA,CAAAE,IAAA;cAAA,OAGoBf,gBAAgB,CAACiB,eAAjB,CAAiC,IAAjC,EAAuC,UAAAC,IAAI,EAAI;gBACxE,OAAOA,IAAI,CAAClD,UAAL,GAAkB,CAAlB,GAAsB,CAAC,CAA9B;cACD,CAF0B,CAA3B;YAAA;cAAMyC,YAAY,GAAAI,QAAA,CAAAM,IAAA;cAAA,IAIbV,YAAL;gBAAAI,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACE,KAAKtC,YAAL,GAAoB,IAApB;cAAA,OAAAoC,QAAA,CAAAO,MAAA;YAAA;cAAA,KAIE,KAAK3C,YAAT;gBAAAoC,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACEN,YAAY,CAACY,IAAb;cAAA,OAAAR,QAAA,CAAAO,MAAA;YAAA;cAIEV,QAAsB,GAAG,IAA7B;cAAAG,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAGmBhB,OAAO,CAAC;gBAACnC,KAAD,EAACA,KAAD;gBAAQuC,EAAR,EAAQA,EAAR;gBAAYC,IAAZ,EAAYA,IAAZ;gBAAkBC,QAAlB,EAAkBA,QAAlB;gBAA4BC,IAA5B,EAA4BA,IAA5B;gBAAkCE,MAAA,EAAAA;cAAlC,CAAD,CAAxB;YAAA;cAAAE,QAAQ,GAAAG,QAAA,CAAAM,IAAA;cAAAN,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAS,EAAA,GAAAT,QAAA;cAERtB,KAAK,GAAGsB,QAAA,CAAAS,EAAA,IAAO,IAAf;YAAA;cAAAT,QAAA,CAAAC,IAAA;cAEAL,YAAY,CAACY,IAAb;cAAA,OAAAR,QAAA,CAAAU,MAAA;YAAA;cAAA,MAIEhB,QAAQ,KAAK,KAAKhC,SAAtB;gBAAAsC,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAA,OAAAF,QAAA,CAAAO,MAAA;YAAA;cAIA,KAAKhD,OAAL,GAAeC,SAAf;cAGA,KAAKF,OAAL,GAAeuC,QAAf;cAAA,MAGI,KAAKjC,YAAL,IAAqB,CAACiC,QAA1B;gBAAAG,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACE,KAAKvC,SAAL,GAAiB,KAAjB;cAAA,OAAAqC,QAAA,CAAAO,MAAA;YAAA;cAGF,KAAK5C,SAAL,GAAiB,IAAjB;cACA,KAAKC,YAAL,GAAoB,KAApB;cAEA,IAAIc,KAAJ,EAAW;gBACTW,OAAO,CAACX,KAAD,EAAQ,IAAR,CAAP;cACD,CAFD,MAEO;gBACLU,MAAM,CAAC,IAAD,CAAN;cACD;YAAA;YAAA;cAAA,OAAAY,QAAA,CAAAW,IAAA;UAAA;QAAA,GAAA3B,OAAA;MAAA,CACF;MAAA,SAAA4B,UAAAC,EAAA;QAAA,OAAAjC,UAAA,CAAAkC,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAH,SAAA;IAAA;EAAA;IAAA7C,GAAA;IAAAY,KAAA,EAED,SAAAqC,SAASC,IAAD,EAAyC;MAC/C,KAAKtD,SAAL,GAAiB,KAAjB;MACA,KAAKC,YAAL,GAAoB,KAApB;MACA,KAAKC,YAAL,GAAoB,KAApB;MACA,KAAKH,SAAL;MACA,KAAKH,OAAL,GAAe,KAAKqD,SAAL,CAAeK,IAAf,CAAf;MACA,OAAO,KAAK1D,OAAZ;IACD;EAAA;IAAAQ,GAAA;IAAAY,KAAA,EAED,SAAAuC,eAAA,EAAuB;MACrB,IAAI,KAAKhD,SAAT,EAAoB;QAClB,KAAKiD,KAAL;QACA,KAAK5D,OAAL,GAAeC,SAAf;MACD;MACD,KAAKK,YAAL,GAAoB,IAApB;IACD;EAAA;IAAAE,GAAA;IAAAY,KAAA,EAED,SAAAwC,MAAA,EAAc;MAAA,IAAAC,qBAAA;MACZ,IAAI,KAAKC,QAAT,EAAmB;QACjB;MACD;MAED,KAAKzD,YAAL,GAAoB,IAApB;MACA,CAAAwD,qBAAA,QAAK3D,gBAAL,cAAA2D,qBAAA,uBAAAA,qBAAA,CAAuBD,KAAvB;IACD;EAAA;EAAA,OAAArE,YAAA;AAAA;AAAA,SAtJkBA,YAAN,IAAAwE,OAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}