{"ast":null,"code":"// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _d3Scale = require(\"d3-scale\");\nvar _d3Array = require(\"d3-array\");\nvar _d3Color = require(\"d3-color\");\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\nvar _templateObject;\nvar histogramStyle = {\n  highlightW: 0.7,\n  unHighlightedW: 0.4\n};\nvar HistogramWrapper = _styledComponents[\"default\"].svg(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  overflow: visible;\\n\"])));\nvar BarUnmemoized = _styledComponents[\"default\"].rect(function (_ref) {\n  var theme = _ref.theme,\n    inRange = _ref.inRange,\n    color = _ref.color;\n  return \"\\n  \".concat(inRange ? \"fill: \".concat(color !== null && color !== void 0 ? color : theme.histogramFillInRange, \";\") : \"fill: \".concat(color ? (0, _d3Color.hcl)(color).darker() : theme.histogramFillOutRange, \";\"), \"\\n\");\n});\nvar Bar = /*#__PURE__*/_react[\"default\"].memo(BarUnmemoized);\nBar.displayName = 'Bar';\nfunction HistogramPlotFactory() {\n  var HistogramPlot = function HistogramPlot(_ref2) {\n    var width = _ref2.width,\n      height = _ref2.height,\n      margin = _ref2.margin,\n      isRanged = _ref2.isRanged,\n      histogram = _ref2.histogram,\n      value = _ref2.value,\n      brushComponent = _ref2.brushComponent;\n    var undefinedToZero = function undefinedToZero(x) {\n      return x ? x : 0;\n    };\n    var domain = (0, _react.useMemo)(function () {\n      return [histogram[0].x0, histogram[histogram.length - 1].x1].map(function (item) {\n        return undefinedToZero(item);\n      });\n    }, [histogram]);\n    var dataId = Object.keys(histogram[0]).filter(function (k) {\n      return k !== 'x0' && k !== 'x1';\n    })[0]; // use 1st for now\n\n    var getValue = (0, _react.useMemo)(function () {\n      return function (d) {\n        return d[dataId];\n      };\n    }, [dataId]);\n    var x = (0, _react.useMemo)(function () {\n      return (0, _d3Scale.scaleLinear)().domain(domain).range([0, width]);\n    }, [domain, width]);\n    var y = (0, _react.useMemo)(function () {\n      return (0, _d3Scale.scaleLinear)().domain([0, Number((0, _d3Array.max)(histogram, getValue))]).range([0, height]);\n    }, [histogram, height, getValue]);\n    var barWidth = width / histogram.length;\n    return /*#__PURE__*/_react[\"default\"].createElement(HistogramWrapper, {\n      width: width,\n      height: height,\n      style: {\n        marginTop: \"\".concat(margin.top, \"px\")\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(\"g\", {\n      className: \"histogram-bars\"\n    }, histogram.map(function (bar) {\n      var inRange = undefinedToZero(bar.x1) <= value[1] && undefinedToZero(bar.x0) >= value[0];\n      var wRatio = inRange ? histogramStyle.highlightW : histogramStyle.unHighlightedW;\n      return /*#__PURE__*/_react[\"default\"].createElement(Bar, {\n        inRange: inRange,\n        key: bar.x0,\n        height: y(getValue(bar)),\n        width: barWidth * wRatio,\n        x: x(undefinedToZero(bar.x0)) + barWidth * (1 - wRatio) / 2,\n        rx: 1,\n        ry: 1,\n        y: height - y(getValue(bar))\n      });\n    })), /*#__PURE__*/_react[\"default\"].createElement(\"g\", {\n      transform: \"translate(\".concat(isRanged ? 0 : barWidth / 2, \", 0)\")\n    }, brushComponent));\n  };\n  var EmpptyOrPlot = function EmpptyOrPlot(props) {\n    return !props.histogram || !props.histogram.length ? null : /*#__PURE__*/_react[\"default\"].createElement(HistogramPlot, props);\n  };\n  return EmpptyOrPlot;\n}\nvar _default = HistogramPlotFactory;\nexports[\"default\"] = _default;","map":{"version":3,"names":["Object","defineProperty","exports","value","_react","_interopRequireWildcard","require","_d3Scale","_d3Array","_d3Color","_styledComponents","_interopRequireDefault","_templateObject","histogramStyle","highlightW","unHighlightedW","HistogramWrapper","svg","_taggedTemplateLiteral2","theme","_ref","inRange","color","Bar","memo","BarUnmemoized","displayName","HistogramPlotFactory","HistogramPlot","_ref2","height","margin","isRanged","histogram","brushComponent","undefinedToZero","x","domain","useMemo","x0","length","x1","map","item","dataId","keys","filter","k","getValue","d","scaleLinear","range","width","y","Number","max","barWidth","createElement","style","marginTop","concat","top","className","bar","wRatio"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@kepler.gl/components/src/common/histogram-plot.tsx"],"sourcesContent":["// Copyright (c) 2022 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {ReactElement, useMemo} from 'react';\nimport {scaleLinear} from 'd3-scale';\nimport {max} from 'd3-array';\nimport {hcl} from 'd3-color';\nimport styled from 'styled-components';\nimport {HistogramBin} from '@kepler.gl/types';\n\nconst histogramStyle = {\n  highlightW: 0.7,\n  unHighlightedW: 0.4\n};\n\nconst HistogramWrapper = styled.svg`\n  overflow: visible;\n`;\n\ntype BarType = {\n  inRange: boolean;\n};\nconst BarUnmemoized = styled.rect<BarType>(\n  ({theme, inRange, color}) => `\n  ${\n    inRange\n      ? `fill: ${color ?? theme.histogramFillInRange};`\n      : `fill: ${color ? hcl(color).darker() : theme.histogramFillOutRange};`\n  }\n`\n);\nconst Bar = React.memo(BarUnmemoized);\nBar.displayName = 'Bar';\n\ninterface HistogramPlotProps {\n  width: number;\n  height: number;\n  margin: {top: number; bottom: number; left: number; right: number};\n  isRanged?: boolean;\n  histogram: HistogramBin[];\n  value: number[];\n  brushComponent?: ReactElement;\n}\n\nfunction HistogramPlotFactory() {\n  const HistogramPlot = ({\n    width,\n    height,\n    margin,\n    isRanged,\n    histogram,\n    value,\n    brushComponent\n  }: HistogramPlotProps) => {\n    const undefinedToZero = (x: number | undefined) => (x ? x : 0);\n    const domain = useMemo(\n      () =>\n        [histogram[0].x0, histogram[histogram.length - 1].x1].map(item => undefinedToZero(item)),\n      [histogram]\n    );\n    const dataId = Object.keys(histogram[0]).filter(k => k !== 'x0' && k !== 'x1')[0];\n\n    // use 1st for now\n    const getValue = useMemo(() => d => d[dataId], [dataId]);\n\n    const x = useMemo(\n      () =>\n        scaleLinear()\n          .domain(domain)\n          .range([0, width]),\n      [domain, width]\n    );\n\n    const y = useMemo(\n      () =>\n        scaleLinear()\n          .domain([0, Number(max(histogram, getValue))])\n          .range([0, height]),\n      [histogram, height, getValue]\n    );\n\n    const barWidth = width / histogram.length;\n\n    return (\n      <HistogramWrapper width={width} height={height} style={{marginTop: `${margin.top}px`}}>\n        <g className=\"histogram-bars\">\n          {histogram.map(bar => {\n            const inRange =\n              undefinedToZero(bar.x1) <= value[1] && undefinedToZero(bar.x0) >= value[0];\n            const wRatio = inRange ? histogramStyle.highlightW : histogramStyle.unHighlightedW;\n            return (\n              <Bar\n                inRange={inRange}\n                key={bar.x0}\n                height={y(getValue(bar))}\n                width={barWidth * wRatio}\n                x={x(undefinedToZero(bar.x0)) + (barWidth * (1 - wRatio)) / 2}\n                rx={1}\n                ry={1}\n                y={height - y(getValue(bar))}\n              />\n            );\n          })}\n        </g>\n        <g transform={`translate(${isRanged ? 0 : barWidth / 2}, 0)`}>{brushComponent}</g>\n      </HistogramWrapper>\n    );\n  };\n\n  const EmpptyOrPlot = props =>\n    !props.histogram || !props.histogram.length ? null : <HistogramPlot {...props} />;\n\n  return EmpptyOrPlot;\n}\nexport default HistogramPlotFactory;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}