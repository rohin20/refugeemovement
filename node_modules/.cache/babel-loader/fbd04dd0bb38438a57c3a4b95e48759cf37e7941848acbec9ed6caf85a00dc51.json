{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport Resource from './resource';\nimport { FEATURES, hasFeatures } from '../features';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\nvar GL_QUERY_RESULT = 0x8866;\nvar GL_QUERY_RESULT_AVAILABLE = 0x8867;\nvar GL_TIME_ELAPSED_EXT = 0x88bf;\nvar GL_GPU_DISJOINT_EXT = 0x8fbb;\nvar GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN = 0x8c88;\nvar GL_ANY_SAMPLES_PASSED = 0x8c2f;\nvar GL_ANY_SAMPLES_PASSED_CONSERVATIVE = 0x8d6a;\nvar Query = /*#__PURE__*/function (_Resource, _Symbol$toStringTag) {\n  _inherits(Query, _Resource);\n  var _super = _createSuper(Query);\n  function Query(gl) {\n    var _this;\n    _classCallCheck(this, Query);\n    var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _this = _super.call(this, gl, opts);\n    _this.target = null;\n    _this._queryPending = false;\n    _this._pollingPromise = null;\n    Object.seal(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(Query, [{\n    key: _Symbol$toStringTag,\n    get: function get() {\n      return 'Query';\n    }\n  }, {\n    key: \"beginTimeElapsedQuery\",\n    value: function beginTimeElapsedQuery() {\n      return this.begin(GL_TIME_ELAPSED_EXT);\n    }\n  }, {\n    key: \"beginOcclusionQuery\",\n    value: function beginOcclusionQuery() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$conservative = _ref.conservative,\n        conservative = _ref$conservative === void 0 ? false : _ref$conservative;\n      return this.begin(conservative ? GL_ANY_SAMPLES_PASSED_CONSERVATIVE : GL_ANY_SAMPLES_PASSED);\n    }\n  }, {\n    key: \"beginTransformFeedbackQuery\",\n    value: function beginTransformFeedbackQuery() {\n      return this.begin(GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN);\n    }\n  }, {\n    key: \"begin\",\n    value: function begin(target) {\n      if (this._queryPending) {\n        return this;\n      }\n      this.target = target;\n      this.gl2.beginQuery(this.target, this.handle);\n      return this;\n    }\n  }, {\n    key: \"end\",\n    value: function end() {\n      if (this._queryPending) {\n        return this;\n      }\n      if (this.target) {\n        this.gl2.endQuery(this.target);\n        this.target = null;\n        this._queryPending = true;\n      }\n      return this;\n    }\n  }, {\n    key: \"isResultAvailable\",\n    value: function isResultAvailable() {\n      if (!this._queryPending) {\n        return false;\n      }\n      var resultAvailable = this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT_AVAILABLE);\n      if (resultAvailable) {\n        this._queryPending = false;\n      }\n      return resultAvailable;\n    }\n  }, {\n    key: \"isTimerDisjoint\",\n    value: function isTimerDisjoint() {\n      return this.gl2.getParameter(GL_GPU_DISJOINT_EXT);\n    }\n  }, {\n    key: \"getResult\",\n    value: function getResult() {\n      return this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT);\n    }\n  }, {\n    key: \"getTimerMilliseconds\",\n    value: function getTimerMilliseconds() {\n      return this.getResult() / 1e6;\n    }\n  }, {\n    key: \"createPoll\",\n    value: function createPoll() {\n      var _this2 = this;\n      var limit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Number.POSITIVE_INFINITY;\n      if (this._pollingPromise) {\n        return this._pollingPromise;\n      }\n      var counter = 0;\n      this._pollingPromise = new Promise(function (resolve, reject) {\n        var poll = function poll() {\n          if (_this2.isResultAvailable()) {\n            resolve(_this2.getResult());\n            _this2._pollingPromise = null;\n          } else if (counter++ > limit) {\n            reject('Timed out');\n            _this2._pollingPromise = null;\n          } else {\n            requestAnimationFrame(poll);\n          }\n        };\n        requestAnimationFrame(poll);\n      });\n      return this._pollingPromise;\n    }\n  }, {\n    key: \"_createHandle\",\n    value: function _createHandle() {\n      return Query.isSupported(this.gl) ? this.gl2.createQuery() : null;\n    }\n  }, {\n    key: \"_deleteHandle\",\n    value: function _deleteHandle() {\n      this.gl2.deleteQuery(this.handle);\n    }\n  }], [{\n    key: \"isSupported\",\n    value: function isSupported(gl) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var webgl2 = isWebGL2(gl);\n      var hasTimerQuery = hasFeatures(gl, FEATURES.TIMER_QUERY);\n      var supported = webgl2 || hasTimerQuery;\n      var _iterator = _createForOfIteratorHelper(opts),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var key = _step.value;\n          switch (key) {\n            case 'queries':\n              supported = supported && webgl2;\n              break;\n            case 'timers':\n              supported = supported && hasTimerQuery;\n              break;\n            default:\n              assert(false);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return supported;\n    }\n  }]);\n  return Query;\n}(Resource, Symbol.toStringTag);\nexport { Query as default };","map":{"version":3,"names":["Resource","FEATURES","hasFeatures","isWebGL2","assert","GL_QUERY_RESULT","GL_QUERY_RESULT_AVAILABLE","GL_TIME_ELAPSED_EXT","GL_GPU_DISJOINT_EXT","GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN","GL_ANY_SAMPLES_PASSED","GL_ANY_SAMPLES_PASSED_CONSERVATIVE","Query","_Resource","_Symbol$toStringTag","_inherits","_super","_createSuper","gl","_this","_classCallCheck","opts","arguments","length","undefined","call","target","_queryPending","_pollingPromise","Object","seal","_assertThisInitialized","_createClass","key","get","value","beginTimeElapsedQuery","begin","beginOcclusionQuery","_ref","_ref$conservative","conservative","beginTransformFeedbackQuery","gl2","beginQuery","handle","end","endQuery","isResultAvailable","resultAvailable","getQueryParameter","isTimerDisjoint","getParameter","getResult","getTimerMilliseconds","createPoll","_this2","limit","Number","POSITIVE_INFINITY","counter","Promise","resolve","reject","poll","requestAnimationFrame","_createHandle","isSupported","createQuery","_deleteHandle","deleteQuery","webgl2","hasTimerQuery","TIMER_QUERY","supported","_iterator","_createForOfIteratorHelper","_step","s","n","done","err","e","f","Symbol","toStringTag","default"],"sources":["/Users/rohinphukan/Desktop/RefugeeWebsite/node_modules/@luma.gl/webgl/src/classes/query.js"],"sourcesContent":["// WebGL2 Query (also handles disjoint timer extensions)\nimport Resource from './resource';\nimport {FEATURES, hasFeatures} from '../features';\nimport {isWebGL2} from '@luma.gl/gltools';\nimport {assert} from '../utils/assert';\n\nconst GL_QUERY_RESULT = 0x8866; // Returns a GLuint containing the query result.\nconst GL_QUERY_RESULT_AVAILABLE = 0x8867; // whether query result is available.\n\nconst GL_TIME_ELAPSED_EXT = 0x88bf; // Elapsed time (in nanoseconds).\nconst GL_GPU_DISJOINT_EXT = 0x8fbb; // Whether GPU performed any disjoint operation.\n\nconst GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN = 0x8c88; // #primitives written to feedback buffers\nconst GL_ANY_SAMPLES_PASSED = 0x8c2f; // Occlusion query (if drawing passed depth test)\nconst GL_ANY_SAMPLES_PASSED_CONSERVATIVE = 0x8d6a; // Occlusion query less accurate/faster version\n\nexport default class Query extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Query';\n  }\n  // Returns true if Query is supported by the WebGL implementation\n  // Can also check whether timestamp queries are available.\n  static isSupported(gl, opts = []) {\n    const webgl2 = isWebGL2(gl);\n\n    // Initial value\n    const hasTimerQuery = hasFeatures(gl, FEATURES.TIMER_QUERY);\n    let supported = webgl2 || hasTimerQuery;\n\n    for (const key of opts) {\n      switch (key) {\n        case 'queries':\n          supported = supported && webgl2;\n          break;\n        case 'timers':\n          supported = supported && hasTimerQuery;\n          break;\n        default:\n          assert(false);\n      }\n    }\n\n    return supported;\n  }\n\n  // Create a query class\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n\n    this.target = null;\n    this._queryPending = false;\n    this._pollingPromise = null;\n\n    Object.seal(this);\n  }\n\n  // Shortcut for timer query (dependent on extension in both WebGL1 and 2)\n  // Measures GPU time delta between this call and a matching `end` call in the\n  // GPU instruction stream.\n  beginTimeElapsedQuery() {\n    return this.begin(GL_TIME_ELAPSED_EXT);\n  }\n\n  // Shortcut for occlusion queries\n  beginOcclusionQuery({conservative = false} = {}) {\n    return this.begin(conservative ? GL_ANY_SAMPLES_PASSED_CONSERVATIVE : GL_ANY_SAMPLES_PASSED);\n  }\n\n  // Shortcut for transformFeedbackQuery\n  beginTransformFeedbackQuery() {\n    return this.begin(GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN);\n  }\n\n  // Due to OpenGL API limitations, after calling `begin()` on one Query\n  // instance, `end()` must be called on that same instance before\n  // calling `begin()` on another query. While there can be multiple\n  // outstanding queries representing disjoint `begin()`/`end()` intervals.\n  // It is not possible to interleave or overlap `begin` and `end` calls.\n  begin(target) {\n    // Don't start a new query if one is already active.\n    if (this._queryPending) {\n      return this;\n    }\n\n    this.target = target;\n    this.gl2.beginQuery(this.target, this.handle);\n\n    return this;\n  }\n\n  // ends the current query\n  end() {\n    // Can't end a new query if the last one hasn't been resolved.\n    if (this._queryPending) {\n      return this;\n    }\n\n    if (this.target) {\n      this.gl2.endQuery(this.target);\n      this.target = null;\n      this._queryPending = true;\n    }\n    return this;\n  }\n\n  // Returns true if the query result is available\n  isResultAvailable() {\n    if (!this._queryPending) {\n      return false;\n    }\n\n    const resultAvailable = this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT_AVAILABLE);\n    if (resultAvailable) {\n      this._queryPending = false;\n    }\n    return resultAvailable;\n  }\n\n  // Timing query is disjoint, i.e. results are invalid\n  isTimerDisjoint() {\n    return this.gl2.getParameter(GL_GPU_DISJOINT_EXT);\n  }\n\n  // Returns query result.\n  getResult() {\n    return this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT);\n  }\n\n  // Returns the query result, converted to milliseconds to match JavaScript conventions.\n  getTimerMilliseconds() {\n    return this.getResult() / 1e6;\n  }\n\n  // Polls the query\n  createPoll(limit = Number.POSITIVE_INFINITY) {\n    if (this._pollingPromise) {\n      return this._pollingPromise;\n    }\n\n    let counter = 0;\n\n    this._pollingPromise = new Promise((resolve, reject) => {\n      const poll = () => {\n        if (this.isResultAvailable()) {\n          resolve(this.getResult());\n          this._pollingPromise = null;\n        } else if (counter++ > limit) {\n          reject('Timed out');\n          this._pollingPromise = null;\n        } else {\n          requestAnimationFrame(poll);\n        }\n      };\n\n      requestAnimationFrame(poll);\n    });\n\n    return this._pollingPromise;\n  }\n\n  _createHandle() {\n    return Query.isSupported(this.gl) ? this.gl2.createQuery() : null;\n  }\n\n  _deleteHandle() {\n    this.gl2.deleteQuery(this.handle);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}